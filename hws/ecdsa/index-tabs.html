<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' lang='' xml:lang=''>
<head>
  <meta charset='utf-8'></meta>
  <meta name='generator' content='pandoc'></meta>
  <meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=yes'></meta>
  <title>ECDSA Implementation</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel='stylesheet' href='../../markdown.css'></link>
  <script>
  function openTab(evt, tabName) {
    // Declare all variables
    var i, tabcontent, tablinks;

    // Get all elements with class="tabcontent" and hide them
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }

    // Get all elements with class="tablinks" and remove the class "active"
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
    }

    // Show the current tab, and add an "active" class to the button that opened the tab
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
  }
  </script>
  
</head>
<body>
<h1 id='ecdsa-implementation'>ECDSA Implementation</h1>
<p><a href='../index.html'>Go up to the CCC HW page</a> (<a href='../index.md'>md</a>) | <a href='index.html'>view standard version</a></p><div class='tab'>
<button class='tablinks' onclick="openTab(event,'toverview')" id='defaultOpen'>Overview</button>
<button class='tablinks' onclick="openTab(event,'tchangelog')">Changelog</button>
<button class='tablinks' onclick="openTab(event,'tbackground')">Background</button>
<button class='tablinks' onclick="openTab(event,'tlanguages')">Languages</button>
<button class='tablinks' onclick="openTab(event,'tother-files')">Other Files</button>
<button class='tablinks' onclick="openTab(event,'tstep-1-finite-fields')">Finite Fields</button>
<button class='tablinks' onclick="openTab(event,'tstep-2-ec-operations')">EC Operations</button>
<button class='tablinks' onclick="openTab(event,'tstep-3-signatures')">Signatures</button>
<button class='tablinks' onclick="openTab(event,'tstep-4-correct-io')">Correct I/O</button>
<button class='tablinks' onclick="openTab(event,'texample')">Example</button>
<button class='tablinks' onclick="openTab(event,'ttesting')">Testing</button>
<button class='tablinks' onclick="openTab(event,'tsubmission')">Submission</button>
</div>
<div id='toverview' class='tabcontent'><h3 id='overview'>Overview</h3>
<p>In this homework you will implement the ECDSA algorithm.</p>
<p>The sizes of the numbers we are using will be small – all 1,000 (base 10) or less. While we are not particularly interested in efficiency, your program does have to run in a reasonable amount of time (say, a second or less). In particular, your elliptic curve multiplication must be a logarithmic time algorithm (relative to <span class='math inline'><em>k</em></span>), not a linear time algorithm.</p>
<p>In this homework, it is critical to carefully test each stage of the assignment. Each part requires that the previous part works properly – and, if it does not, then it will be exceedingly difficult to debug your program. If you get stuck, the best way to figure out where the bug is is to print out the values at each step, and verify them by hand (or via online calculators, linked to below).</p>
</div><div id='tchangelog' class='tabcontent'><h3 id='changelog'>Changelog</h3>
<p>Any changes to this page will be put here for easy reference. Typo fixes and minor clarifications are not listed here. So far there aren’t any significant changes to report.</p>
</div><div id='tbackground' class='tabcontent'><h3 id='background'>Background</h3>
<p>You will need to be familiar with the <a href='../../slides/encryption.html#/'>Encryption slide set</a>, specifically the three sections that deal with the content in this assignment: <a href='../../slides/encryption.html#/elliptic'>elliptic curves</a>, <a href='../../slides/encryption.html#/fields'>finite fields</a>, and <a href='../../slides/encryption.html#/ecdsa'>ECDSA</a>. What this assignment is asking for will make no sense if you are not familiar with that material.</p>
</div><div id='tlanguages' class='tabcontent'><h3 id='languages'>Languages</h3>
<p>You can write this assignment in Java or Python. If you want to use a different language, please speak to me first. The intent is for you to write all this code yourself – you can NOT use any libraries that do field arithmetic, elliptic curve arithmetic, etc. This includes any hashing functions (such as hashlib in Python). We expect you to only need the most common standard libraries as a result.</p>
<p>We realize that the default random number generators in most (all?) programming languages are not cryptographically secure random number generators, but that’s fine for this assignment.</p>
</div><div id='tother-files' class='tabcontent'><h3 id='other-files'>Other files</h3>
<p>We are going to call your program by calling an <code>ecdsa.sh</code> shell script. Any parameters passed to the shell script will be passed as-is to your program. This is what your ecdsa.sh script should look like if you are using Python:</p>
<pre><code>#!/bin/bash
python3 ecdsa.py $@</code></pre>
<p>If you are using Java, it would look like this:</p>
<pre><code>#!/bin/bash
java ECDSA $@</code></pre>
<p>Of course, you should change the second line to match the file/class names that you choose.</p>
<p>You will also have to submit a <code>Makefile</code> that will be used to compile your program, if needed. For languages that do not need compilation (such as Python), just put in a single <code>echo</code> statement so that <code>make</code> still runs properly. This is the same as in the <a href='../intro/index.html'>last assignment</a> (<a href='../intro/index.md'>md</a>).</p>
</div><div id='tstep-1-finite-fields' class='tabcontent'><h3 id='step-1-finite-fields'>Step 1: Finite Fields</h3>
<p>The first step is to ensure that you have all the finite field arithmetic functions that are necessary. Some of these are easy – addition and multiplication, for example. Others are a bit more challenging, such as division. You will likely want to reference the <a href='../../slides/encryption.html#/fields'>finite field section of the lecture slides</a>. In addition to the four standard arithmetic operations, you will likely also need exponentiation, obtaining the additive inverse, and obtaining the multiplicative inverse. Some functions will likely use others – division of <span class='math inline'><em>a</em></span> by <span class='math inline'><em>x</em></span> is just multiplying <span class='math inline'><em>a</em></span> by the multiplicative inverse of <span class='math inline'><em>x</em></span>, for example.</p>
<p>The field size should be a parameter to the functions, or a global variable, as that will change with different execution runs.</p>
<p>Test these well to ensure that they work! You can test your operations by using the arithmetic identities: if <span class='math inline'><em>x</em></span> is the multiplicative inverse of <span class='math inline'><em>y</em></span>, then <span class='math inline'><em>x</em> * <em>y</em> =  = 1</span>, for example.</p>
</div><div id='tstep-2-ec-operations' class='tabcontent'><h3 id='step-2-ec-operations'>Step 2: EC operations</h3>
<p>There are three elliptic curve point operations that will be needed:</p>
<ul>
<li>Elliptic curve addition of a point to itself: <span class='math inline'><em>P</em> = <em>Q</em> ⊕ <em>Q</em></span>. For this operation you will need to determine the slope of the secp256k1 curve <span class='math inline'><em>y</em><sup>2</sup> = <em>x</em><sup>3</sup> + 7</span>; that derivative is <span class='math inline'><em>d</em><em>y</em>/<em>d</em><em>x</em> = 3<em>x</em><sup>2</sup>/2<em>y</em></span>; this is discussed on <a href='../../slides/encryption.html#/secp256k1derivative'>this slide</a> of the <a href='../../slides/encryption.html#/'>encryption slide set</a>.</li>
<li>Elliptic curve addition of two different points: <span class='math inline'><em>P</em> = <em>Q</em> ⊕ <em>R</em></span></li>
<li>Elliptic curve multiplication of a point by a scalar value: <span class='math inline'><em>P</em> = <em>k</em> ⊗ <em>Q</em></span>. Really this is performing elliptic curve addition of that point <span class='math inline'><em>k</em></span> times, but we can’t do that many additions (that’s a linear time operation relative to <span class='math inline'><em>k</em></span>) – instead, this needs to be a logarithmic operation, as discussed in lecture (specifically, <a href='../../slides/encryption.html#/computingkg'>here</a>).</li>
</ul>
<p>Some references from the lecture slides:</p>
<ul>
<li>The <a href='../../slides/encryption.html#/elliptic'>elliptic curve section</a> of the encryption slide set shows how these operations work visually (albeit in the real numbers)</li>
<li>The last few slides in the <a href='../../slides/encryption.html#/fields'>finite field section</a> discusses how to perform this arithmetic in a field.</li>
</ul>
<p>You can test your functions by using two websites: one that does <a href='https://andrea.corbellini.name/ecc/interactive/modk-add.html?a=0&b=7&p=43'>elliptic curve addition in a field</a> and one that does <a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43'>elliptic curve multiplication in a field</a>. The curve we are using is secp256k1, which sets <span class='math inline'><em>a</em> = 0</span> and <span class='math inline'><em>b</em> = 7</span>. For testing purposes, we recommend setting the prime modulus <span class='math inline'><em>p</em></span> to 43; this will give an curve order (<span class='math inline'><em>o</em></span>) value of 31.</p>
</div><div id='tstep-3-signatures' class='tabcontent'><h3 id='step-3-signatures'>Step 3: Signatures</h3>
<p>Lastly, you can proceed to generate the signature and then validate it; this is discussed in the <a href='../../slides/encryption.html#/ecdsa'>ECDSA section</a> of the encryption slide set.</p>
<p>We recommend reading through the next section, on input and output, before starting to work on this section.</p>
<p>Your program will need to be able to perform three primary functions:</p>
<ul>
<li>Key generation: choose a random value <span class='math inline'><em>d</em></span>, the private key, such that <span class='math inline'>1 ≤ <em>d</em> ≤ <em>n</em> − 1</span>, and use that to determine the public key, point <span class='math inline'><em>Q</em></span>, such that <span class='math inline'><em>Q</em> = <em>d</em> ⊗ <em>G</em></span>. The values needed for these computations (<span class='math inline'><em>p</em></span>, <span class='math inline'><em>o</em></span>, and <span class='math inline'><em>G</em></span>) will be provided.</li>
<li>Signing a message: Given the curve parameters (<span class='math inline'><em>p</em></span>, <span class='math inline'><em>o</em></span>, and <span class='math inline'><em>G</em></span>), the private key (<span class='math inline'><em>d</em></span>), and the hash (<span class='math inline'><em>h</em></span>) of the message to be signed, you should generate the <span class='math inline'>(<em>r</em>,<em>s</em>)</span> ECDSA signature.</li>
<li>Verifying a message: Given the curve parameters (<span class='math inline'><em>p</em></span>, <span class='math inline'><em>o</em></span>, and <span class='math inline'><em>G</em></span>), the public key <span class='math inline'><em>Q</em></span>, the signature <span class='math inline'>(<em>r</em>,<em>s</em>)</span>, and the hash <span class='math inline'><em>h</em></span>, you should verify that the signature is (or is not) valid.</li>
</ul>
<p>We will only be using the secp256k1 curve, so you can always assume that <span class='math inline'><em>a</em> = 0</span> and <span class='math inline'><em>b</em> = 7</span>.</p>
</div><div id='tstep-4-correct-io' class='tabcontent'><h3 id='step-4-correct-io'>Step 4: Correct I/O</h3>
<p>Your program will take in a number of command line parameters. You can always assume that the number and format of command line parameters will be correct, as specified below – you do not need to error check the parameters (neither the number nor the format). You may also assume that any points provided (such as <span class='math inline'><em>G</em></span> or <span class='math inline'><em>Q</em></span>) will always lie on the curve. Your program will only use the secp256k1 curve for all execution runs, so you can globally set <span class='math inline'><em>a</em> = 0</span> and <span class='math inline'><em>b</em> = 7</span>; these values will not be passed to the program.</p>
<p>Each execution run of the program will take in a string as the first command-line parameter; this is the so-called <em>mode</em>. After the mode will be a series of integer command-line parameters, all of which will be integers. In most of the modes, the first four integer parameters will be, in this order: the prime modulus <span class='math inline'><em>p</em></span>, the curve order <span class='math inline'><em>o</em></span>, and the <span class='math inline'><em>x</em></span> and <span class='math inline'><em>y</em></span> values for the base point <span class='math inline'><em>G</em></span>. All numerical values provided will be non-negative integers not greater than 1,000. All numbers provided as input parameters, or output by the program, are base-10 numbers. And both <span class='math inline'><em>p</em></span> and <span class='math inline'><em>o</em></span> will be prime numbers when we test your code.</p>
<p>The four required modes of the program are:</p>
<ul>
<li><p><code>userid</code> will just print your userid. All lower-case, no quotes, and no extra spaces. There will not be any other command-line parameters. Below is an execution run. Needless to say, it should print out <em>your</em> userid, not ‘mst3k’.</p>
<pre><code>$ ./ecdsa.sh userid
mst3k
$</code></pre></li>
</ul>
<p> </p>
<ul>
<li><p><code>genkey</code> will generate a (random) primary key <span class='math inline'><em>d</em></span> such that <span class='math inline'>1 ≤ <em>d</em> ≤ <em>n</em> − 1</span>, and use that to compute the public key, point <span class='math inline'><em>Q</em></span>. The numerical command-line parameters are just the four described above (<span class='math inline'><em>p</em></span>, <span class='math inline'><em>o</em></span>, <span class='math inline'><em>G</em><sub><em>x</em></sub></span>, and <span class='math inline'><em>G</em><sub><em>y</em></sub></span>). The output should be three integers, one on each line: <span class='math inline'><em>d</em></span>, <span class='math inline'><em>Q</em><sub><em>x</em></sub></span>, and <span class='math inline'><em>Q</em><sub><em>y</em></sub></span>. You can verify <a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43'>here</a> that the values returned are correct (specifically that <span class='math inline'><em>Q</em> = <em>d</em> ⊗ <em>G</em></span>). Below is a sample execution run, which uses <span class='math inline'><em>p</em> = 43</span>, <span class='math inline'><em>o</em> = 31</span>, and <span class='math inline'><em>G</em> = (25,25)</span>. Since this output is based on a random number that is generated (specifically, <span class='math inline'><em>d</em></span>), one would expect that your output would be different on each execution run. The result of the execution run shown is that the private key is <span class='math inline'><em>d</em> = 16</span> and the public key is <span class='math inline'><em>Q</em> = (37,36)</span>.</p>
<pre><code>$ ./ecdsa.sh genkey 43 31 25 25
16
37
36
$</code></pre></li>
</ul>
<p> </p>
<ul>
<li><p><code>sign</code> will sign a message. In addition to the four standard numerical parameters (<span class='math inline'><em>p</em></span>, <span class='math inline'><em>o</em></span>, <span class='math inline'><em>G</em><sub><em>x</em></sub></span>, and <span class='math inline'><em>G</em><sub><em>y</em></sub></span>), there will be two more provided: <span class='math inline'><em>d</em></span> and <span class='math inline'><em>h</em></span>. The first these, <span class='math inline'><em>d</em></span> is the private key, and was part of the output from the <code>genkey</code> mode, above. The second one, <span class='math inline'><em>h</em></span>, is meant to represent the hash of the message that is being signed – it will be an integer in the range <span class='math inline'>1 ≤ <em>h</em> ≤ <em>n</em> − 1</span>. To simplify this assignment, we are not providing the message <span class='math inline'><em>m</em></span> that you are to take the hash of – we are just providing the hash value itself. Note that <span class='math inline'><em>Q</em></span> is not needed for signing, and is thus not provided. To be clear, the six numerical parameters are, in order: (<span class='math inline'><em>p</em></span>, <span class='math inline'><em>o</em></span>, <span class='math inline'><em>G</em><sub><em>x</em></sub></span>, <span class='math inline'><em>G</em><sub><em>y</em></sub></span>, <span class='math inline'><em>d</em></span>, and <span class='math inline'><em>h</em></span>). The output should be two integers, one on each line: the <span class='math inline'><em>r</em></span> and <span class='math inline'><em>s</em></span> values of the signature. Note that the generated random – and secret – value <span class='math inline'><em>k</em></span> is <em>not</em> part of the output, as would be expected with a typical ECDSA implementation. And if <span class='math inline'><em>r</em></span> or <span class='math inline'><em>s</em></span> are zero, your program should re-generate <span class='math inline'><em>k</em></span> and try again – there should be no apparent difference in the output. Below is a sample execution run, which uses <span class='math inline'><em>p</em> = 43</span>, <span class='math inline'><em>o</em> = 31</span>, <span class='math inline'><em>G</em> = (25,25)</span>, <span class='math inline'><em>d</em> = 16</span>, and <span class='math inline'><em>h</em> = 30</span> (the public key, <span class='math inline'><em>Q</em> = (37,36)</span>, is not part of the parameter list). Since this output is based on a random number that is generated (specifically, <span class='math inline'><em>k</em></span>), one would expect that your output would be different on each execution run. The result of the execution run below is that the signature is <span class='math inline'>(<em>r</em>,<em>s</em>) = (12,24)</span>.</p>
<pre><code>$ ./ecdsa.sh sign 43 31 25 25 16 30
12
24
$</code></pre></li>
</ul>
<p> </p>
<ul>
<li><p><code>verify</code> will verify a message. In addition to the four standard numerical parameters (<span class='math inline'><em>p</em></span>, <span class='math inline'><em>o</em></span>, <span class='math inline'><em>G</em><sub><em>x</em></sub></span>, and <span class='math inline'><em>G</em><sub><em>y</em></sub></span>), there will be five more parameters provided. The next two are the public key: <span class='math inline'><em>Q</em><sub><em>x</em></sub></span> and <span class='math inline'><em>Q</em><sub><em>y</em></sub></span> (the verifier does not know the private key!). Following that are the parts of the signature, <span class='math inline'><em>r</em></span> and <span class='math inline'><em>s</em></span>. Lastly will be the (computed) hash of the message that is being verified. To be clear, the nine numerical parameters are, in order: (<span class='math inline'><em>p</em></span>, <span class='math inline'><em>o</em></span>, <span class='math inline'><em>G</em><sub><em>x</em></sub></span>, <span class='math inline'><em>G</em><sub><em>y</em></sub></span>, <span class='math inline'><em>Q</em><sub><em>x</em></sub></span>, <span class='math inline'><em>Q</em><sub><em>y</em></sub></span>, <span class='math inline'><em>r</em></span>, <span class='math inline'><em>s</em></span>, and <span class='math inline'><em>h</em></span>). The output should just be ‘True’ if the signature matches, and ‘False’ if it does not – case matters here! Below are two sample execution runs, which set <span class='math inline'><em>p</em> = 43</span>, <span class='math inline'><em>o</em> = 31</span>, <span class='math inline'><em>G</em> = (25,25)</span>, <span class='math inline'><em>Q</em> = (37,36)</span>, <span class='math inline'>(<em>r</em>,<em>s</em>) = (12,24)</span>, and (<span class='math inline'><em>h</em> = 30</span> or <span class='math inline'><em>h</em> = 29</span>). This output is <em>not</em> based on a random number, so your program should have the same output for these two execution runs.</p>
<pre><code>$ ./ecdsa.sh verify 43 31 25 25 37 36 12 24 30
True
$ ./ecdsa.sh verify 43 31 25 25 37 36 12 24 29
False
$</code></pre></li>
</ul>
<p>Note: please do not print out any other output for those modes, else your program will be marked incorrect by the auto-grader! You are welcome to add additional modes that you use for debugging, or that perform the above functions with verbose output. But the four required modes – <code>userid</code>, <code>genkey</code>, <code>sign</code>, and <code>verify</code> – should only produce the output shown above.</p>
<p>Your code may occasionally incorrectly verify a invalid signature! The computation of <span class='math inline'><em>s</em></span> is computed mod <span class='math inline'><em>o</em></span>, which – in this example – is only 31. This means about 1 in 31 random but invalid signatures would be expected to verify as true. (In reality, with secp256k1, <span class='math inline'><em>o</em> ≈ 1.16 * 10<sup>77</sup></span>, the chance of an invalid signature returning true is quite small). If you do get an invalid signature (or two or three) to return true, just try some other values.</p>
</div><div id='texample' class='tabcontent'><h3 id='example'>Example</h3>
<p>To help you understand the previous example, below is the complete formulaic work-up of the values that were computed above in the three execution runs. All elliptic point computations can be verified <a href='https://andrea.corbellini.name/ecc/interactive/modk-add.html?a=0&b=7&p=43'>here for addition</a> and <a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43'>here for multiplication</a>; verification links are them are also provided below. Note that some of the values used (specifically <span class='math inline'><em>d</em></span> and <span class='math inline'><em>k</em></span>) are randomly generated, so we would expect them to be different in your execution runs.</p>
<p>To ensure clarity about the operations, the <span class='math inline'>+</span> symbol is <em>only</em> used for scalar addition (meaning between two numbers) and the <span class='math inline'>*</span> symbol is <em>only</em> used for scalar multiplication (meaning between two numbers). Addition of two elliptic points uses the <span class='math inline'>⊕</span> symbol, and multiplication of an elliptic point by a scalar uses the <span class='math inline'>⊗</span> symbol.</p>
<p>We know that the prime modulus <span class='math inline'><em>p</em> = 43</span>, the order <span class='math inline'><em>o</em> = 31</span>, and the base point <span class='math inline'><em>G</em> = (25,25)</span>, as these were given in the first four numeric command-line parameters.</p>
<p><strong>Key generation:</strong> The random value for the private key is <span class='math inline'><em>d</em> = 16</span>. Computing <span class='math inline'><em>d</em> ⊗ <em>G</em> = 16 ⊗ (25,25) = (37,36)</span> (<a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43&n=16&px=25&py=25'>verification</a>).</p>
<p><strong>Signing:</strong> The secret <span class='math inline'><em>k</em></span> value, which was not shown, was <span class='math inline'><em>k</em> = 17</span>. We compute <span class='math inline'><em>R</em> = <em>k</em> ⊗ <em>G</em> = 17 ⊗ (25,25) = (12,12)</span> (<a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43&n=17&px=25&py=25'>verification</a>). The <span class='math inline'><em>x</em></span>-value of this, 12, is the first part of the signature, and is referred to as lower-case <span class='math inline'><em>r</em></span>. We next have to compute <span class='math inline'><em>k</em><sup>−1</sup></span>. Because <span class='math inline'><em>k</em></span> is counting the number of points, the inverse is computed in <span class='math inline'><em>Z</em><sub>31</sub></span>, NOT in <span class='math inline'><em>Z</em><sub>43</sub></span>. Thus, in <span class='math inline'><em>Z</em><sub>31</sub></span>, <span class='math inline'>17<sup>−1</sup> = 11</span> (<a href='https://planetcalc.com/3311/?a=17&m=31'>verification</a>; also that <span class='math inline'>11 * 17 mod  31 = 1</span>). We know via the command-line parameters that <span class='math inline'><em>h</em> = 30</span> and <span class='math inline'><em>d</em> = 16</span>, and we have just computed <span class='math inline'><em>r</em> = 12</span>. We can then compute <span class='math inline'><em>s</em></span>, which also is computed in <span class='math inline'><em>Z</em><sub>31</sub></span>, NOT <span class='math inline'><em>Z</em><sub>43</sub></span>: <span class='math inline'><em>s</em> = <em>k</em><sup>−1</sup>(<em>h</em>+<em>r</em>∗<em>d</em>) mod  <em>o</em> = 11 * (30+12*16) mod  31 = 24</span>. Thus, the signature is <span class='math inline'>(<em>r</em>,<em>s</em>) = (12,24)</span>.</p>
<p><strong>Verification:</strong> We are given the values for <span class='math inline'><em>Q</em> = (37,36)</span> and the signature <span class='math inline'>(<em>r</em>,<em>s</em>) = (12,24)</span>. We are given two different hash values, each on its own execution run: the correct hash value of <span class='math inline'><em>h</em> = 30</span> and an incorrect hash value of <span class='math inline'><em>h</em> = 29</span>. As <span class='math inline'><em>s</em></span> was computed in <span class='math inline'><em>Z</em><sub>31</sub></span> (NOT <span class='math inline'><em>Z</em><sub>43</sub></span>), we also compute it’s inverse in <span class='math inline'><em>Z</em><sub>31</sub></span>: <span class='math inline'>24<sup>−1</sup> = 22</span> in <span class='math inline'><em>Z</em><sub>31</sub></span>; (<a href='https://planetcalc.com/3311/?a=24&m=31'>verification</a>; also that <span class='math inline'>22 * 24 mod  31 = 1</span>).</p>
<p>To verify the correct signature (where $h=30), we need to show that <span class='math inline'><em>R</em> = <em>s</em><sup>−1</sup> * <em>h</em> ⊗ <em>G</em> ⊕ <em>s</em><sup>−1</sup> * <em>r</em> ⊗ <em>Q</em></span> = <span class='math inline'>660 ⊗ <em>G</em> ⊕ 264 ⊗ <em>Q</em></span> (this is an equivalent form of the formula used to sign the signature, as shown in the slides starting <a href='../../slides/encryption.html#/ecdsaverify'>here</a>). We can mod those two scalars (660 and 264), but that mod is also in <span class='math inline'><em>Z</em><sub>31</sub></span>, and yields <span class='math inline'><em>R</em> = 9 ⊗ <em>G</em> ⊕ 16 ⊗ <em>Q</em> = 9 ⊗ (25,25) ⊕ 16 ⊗ (37,36) = (2,31) ⊕ (29,31) = (12,12)</span>; (verifications <a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43&n=9&px=25&py=25'>1</a>, <a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43&n=16&px=37&py=36'>2</a>, and <a href='https://andrea.corbellini.name/ecc/interactive/modk-add.html?a=0&b=7&p=43&px=2&py=31&qx=29&qy=31'>3</a>). Because the <span class='math inline'><em>x</em></span>-value of this computed point (i.e., 12) equals the provided <span class='math inline'><em>r</em></span> value in the signature, the signature is valid.</p>
<p>The second execution run had the incorrect hash (<span class='math inline'><em>h</em> = 29</span>). The process is the same as the above – we compute <span class='math inline'><em>R</em> = <em>s</em><sup>−1</sup> * <em>h</em> ⊗ <em>G</em> ⊕ <em>s</em><sup>−1</sup> * <em>r</em> ⊗ <em>Q</em></span>. As <span class='math inline'><em>h</em></span> is different the coefficient in front of <span class='math inline'><em>G</em></span> changes: <span class='math inline'><em>R</em> = 638 ⊗ <em>G</em> ⊕ 264 ⊗ <em>Q</em> = 18 ⊗ <em>G</em> ⊕ 16 ⊗ <em>Q</em> = (7,36) ⊕ (29,31) = (21,18)</span>; (verifications <a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43&n=18&px=25&py=25'>1</a>, <a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43&n=16&px=37&py=36'>2</a>, and <a href='https://andrea.corbellini.name/ecc/interactive/modk-add.html?a=0&b=7&p=43&px=7&py=36&qx=29&qy=31'>3</a>). As the <span class='math inline'><em>x</em></span>-value of that computed <span class='math inline'><em>R</em></span>, specifically the value 21, does not equal the <span class='math inline'><em>r</em> = 12</span> provided with the signature, the signature is not valid.</p>
</div><div id='ttesting' class='tabcontent'><h3 id='testing'>Testing</h3>
<p>One type of test that we are going to perform is whether your program can verify a signature that your code signs, and whether it can indicate as invalid a signature that you did not sign. We will be trying different prime field sizes (all of the ones listed below also have a prime order size). Here are a few examples you can use.</p>
<ul>
<li><span class='math inline'><em>p</em> = 43</span>, <span class='math inline'><em>o</em> = 31</span>, <span class='math inline'><em>G</em> = (25,25)</span></li>
<li><span class='math inline'><em>p</em> = 79</span>, <span class='math inline'><em>o</em> = 67</span>, <span class='math inline'><em>G</em> = (35,8)</span></li>
<li><span class='math inline'><em>p</em> = 127</span>, <span class='math inline'><em>o</em> = 127</span>, <span class='math inline'><em>G</em> = (93,33)</span></li>
<li><span class='math inline'><em>p</em> = 733</span>, <span class='math inline'><em>o</em> = 691</span>, <span class='math inline'><em>G</em> = (336,170)</span></li>
</ul>
<p>Note that if you enter the curve of <span class='math inline'><em>a</em> = 0</span> and <span class='math inline'><em>b</em> = 7</span> into <a href='https://andrea.corbellini.name/ecc/interactive/modk-mul.html?a=0&b=7&p=43'>this site</a>, and enter a different <span class='math inline'><em>p</em></span> value, it will tell you the order below the boxes (“The curve has … points”). You can pick any valid point on that curve as <span class='math inline'><em>G</em></span>; we just arbitrarily picked one for the examples above.</p>
</div><div id='tsubmission' class='tabcontent'><h3 id='submission'>Submission</h3>
<p>You have to submit three files:</p>
<ul>
<li><code>ecdsa.sh</code>, the shell script that will be called to run your program. See above for the format.</li>
<li>A Makefile that will compile your code when we call <code>make</code>, which will be called on submission. For languages that do not need compilation (such as Python), just put in a single <code>echo</code> statement so that <code>make</code> still runs properly.</li>
<li>The source code itself, likely something like <code>ecdsa.py</code> or <code>ECDSA.java</code></li>
</ul>
</div><script>document.getElementById('defaultOpen').click();</script></body>
</html>


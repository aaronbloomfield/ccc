<!DOCTYPE html>
<html lang="en"><head>
<script src="quarto_files/clipboard/clipboard.min.js"></script>
<script src="quarto_files/quarto-html/tabby.min.js"></script>
<script src="quarto_files/quarto-html/popper.min.js"></script>
<script src="quarto_files/quarto-html/tippy.umd.min.js"></script>
<link href="quarto_files/quarto-html/tippy.css" rel="stylesheet">
<link href="quarto_files/quarto-html/light-border.css" rel="stylesheet">
<link href="quarto_files/quarto-html/quarto-syntax-highlighting-dark-8ea72dc5fed832574809a9c94082fbbb.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <title>Encryption</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="quarto_files/revealjs/dist/reset.css">
  <link rel="stylesheet" href="quarto_files/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
  </style>
  <link rel="stylesheet" href="quarto_files/revealjs/dist/theme/quarto-5b48f34d633aed70c74c672477009ffc.css">
  <link rel="stylesheet" href="../slides/ccc.css">
  <link href="quarto_files/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="quarto_files/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="quarto_files/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="quarto_files/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="quarto_files/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="quarto_files/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-dark">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <p class="titlep">&nbsp;</p>
<div class="orangetitle">
  <h1 class="title" style="color:white !important">CS 4790</h1>
  <h2 class="subtitle" style="color:white !important">Cryptocurrency</h2>
  <h2 class="subtitle" style="color:white !important">Encryption</h2>
</div>
  <p class="titlep">&nbsp;</p>
  <p class="titlep">&nbsp;</p>
  <div class="titlesmall"><p>
    <a href="https://www.cs.virginia.edu/~asb">Aaron Bloomfield</a> (aaron@virginia.edu)<br>
    <a href="https://github.com/aaronbloomfield/ccc">@github</a> | <a href="index.html">↑</a> | <a href="?print-pdf"><img class="print" width="20" src="../slides/images/print-icon.svg" style="top:0px;vertical-align:middle;background-color:transparent;display:inline;width:30px;height:30px"></a>
  </p></div>
  <p class="titlep">&nbsp;</p>
</section><section id="TOC">
<nav role="doc-toc"> 
<h2 id="toc-title">Contents</h2>
<ul>
<li><a href="#/overview" id="/toc-overview">Overview</a></li>
<li><a href="#/elliptic-curves" id="/toc-elliptic-curves">Elliptic Curves</a></li>
<li><a href="#/finite-fields" id="/toc-finite-fields">Finite Fields</a></li>
<li><a href="#/ecdsa" id="/toc-ecdsa">ECDSA</a></li>
<li><a href="#/randomness" id="/toc-randomness">Randomness</a></li>
<li><a href="#/hashing" id="/toc-hashing">Hashing</a></li>
<li><a href="#/applied-cryptography" id="/toc-applied-cryptography">Applied Cryptography</a></li>
</ul>
</nav>
</section>
<section>
<section id="overview" class="title-slide slide level1 center">
<h1>Overview</h1>

</section>
<section id="content-coverage" class="slide level2">
<h2>Content coverage</h2>
<ul>
<li>You may have seen some of this material in the <a href="https://aaronbloomfield.github.io/ics/slides/encryption.html#/">encryption slide set</a> from CS 3710: Introduction to Cybersecurity
<ul>
<li>But only this first column of slides is the same (a dozen or so slides)</li>
</ul></li>
<li>If you didn’t see that material, that’s fine
<ul>
<li>We’ll go over all of it</li>
</ul></li>
</ul>
</section>
<section id="codes-versus-ciphers" class="slide level2">
<h2>Codes versus Ciphers</h2>
<ul>
<li>Codes change the meaning of words, ciphers encrypt them</li>
<li>Coded messages:
<ul>
<li>“The light is on in the attic”</li>
<li>“The condor has left the nest”</li>
</ul></li>
<li>Cipher’ed messages:
<ul>
<li>wkh txlfn eurzq ira mxpsv ryhu wkh odcb grj</li>
<li>wecrl teerd soeef eaoca ivden</li>
</ul></li>
<li><a href="http://en.wikipedia.org/wiki/Cipher#Ciphers_versus_codes">Reference</a></li>
</ul>
</section>
<section id="block-ciphers-vs.-stream-ciphers" class="slide level2">
<h2>Block-ciphers vs.&nbsp;stream ciphers</h2>
<ul>
<li>Block ciphers require a block of text (examples: 256 bits (32 bytes), 1 Kb, etc.)
<ul>
<li><a href="http://en.wikipedia.org/wiki/Block_cipher">Reference</a></li>
</ul></li>
<li>Stream ciphers, a.k.a. character ciphers, encrypt data as it is provided, character-by-character
<ul>
<li>I prefer the name ‘character cipher’ over ‘stream cipher’</li>
<li><a href="http://en.wikipedia.org/wiki/Stream_cipher">Reference</a></li>
</ul></li>
</ul>
</section>
<section id="one-time-pad-otp" class="slide level2">
<h2>One-time pad (OTP)</h2>
<ul>
<li>A substitution cipher</li>
<li>Take a <em>random</em> string that is as long as the plain text you want encrypt
<ul>
<li>Use modular arithmetic (or XOR, or Vigenere) to determine the encrypted version</li>
<li>Plain text: helloworld</li>
<li>One-time pad: zdxwhtsvtv</li>
<li>Encrypted: hijiwqhnfz</li>
</ul></li>
<li><a href="http://en.wikipedia.org/wiki/One-time_pad">Reference</a></li>
</ul>
</section>
<section id="one-time-pad-otp-analysis" class="slide level2">
<h2>One-time pad (OTP) analysis</h2>
<ul>
<li>
Pros:
</li>
<ul>
<li>Proven to be perfectly secure if:
<ul>
<li>the pad is truly random</li>
<li>the pad is only used once</li>
<li>the pad is kept secret</li>
</ul></li>
<li>This, it is the ONLY cryptosystem with perfect secrecy</li>
<li>It can be performed by hand</li>
</ul>
<li class="fragment">
<p>Cons:</p>
<ul>
<li>Good for short messages; it’s hard to transport large pads (i.e.&nbsp;network communication)</li>
<li>Does not provide message authentication</li>
<li>How do you get the pad to the recipient?</li>
<li>Can never use it twice</li>
</ul>
</li>
</ul>
</section>
<section id="re-using-a-one-time-pad" class="slide level2">
<h2>Re-using a one-time pad</h2>
<table class="transparent">
<tbody><tr>
<td>
Use an OTP:&nbsp;
</td>
<td>
<img alt="re-using OTP" class="nopad" style="vertical-align:middle;display:initial" src="images/encryption/otp/otp-1.png"> ⊕ <img alt="re-using OTP" class="nopad" style="vertical-align:middle;display:initial;border:2px solid green" src="images/encryption/otp/otp.png"> = <img alt="re-using OTP" class="nopad" style="vertical-align:middle;display:initial;border:2px solid red" src="images/encryption/otp/otp-1e.png">
</td>
</tr>
<tr class="fragment">
<td>
Re-use the<br>same OTP:&nbsp;
</td>
<td>
<img alt="re-using OTP" class="nopad" style="vertical-align:middle;display:initial" src="images/encryption/otp/otp-2.png"> ⊕ <img alt="re-using OTP" class="nopad" style="vertical-align:middle;display:initial;border:2px solid green" src="images/encryption/otp/otp.png"> = <img alt="re-using OTP" class="nopad" style="vertical-align:middle;display:initial;border:2px solid blue" src="images/encryption/otp/otp-2e.png">
</td>
</tr>
<tr class="fragment">
<td>
Extract<br>the images:&nbsp;
</td>
<td>
<img alt="re-using OTP" class="nopad" style="vertical-align:middle;display:initial;border:2px solid red" src="images/encryption/otp/otp-1e.png"> ⊕ <img alt="re-using OTP" class="nopad" style="vertical-align:middle;display:initial;border:2px solid blue" src="images/encryption/otp/otp-2e.png"> = <img alt="re-using OTP" class="nopad" style="vertical-align:middle;display:initial" src="images/encryption/otp/otp-ans.png">
</td>
</tr>
</tbody></table>
<p>
This example from <a href="https://crypto.stackexchange.com/questions/59/taking-advantage-of-one-time-pad-key-reuse">StackExchange</a>
</p>
</section>
<section id="data-encryption-standard-des" class="slide level2">
<h2>Data Encryption Standard (<a href="http://en.wikipedia.org/wiki/Data_Encryption_Standard">DES</a>)</h2>
<ul>
<li>A secret key encryption/decryption block cipher
<ul>
<li>64 bits, but only 56 are usable</li>
</ul></li>
<li>Lots of bit-shifting in rounds to encrypt/decrypt a message</li>
<li>Susceptible to brute force attacks (<span class="math inline">\(2^{56} = 7 \ast 10^{16}\)</span> keys)</li>
<li>Solution: use DES three times =&gt; “Triple DES”
<ul>
<li>Use 168 bit keys: three 56 bit keys, and encrypt the message three times, once with each key</li>
</ul></li>
<li>NIST considers it secure through 2030</li>
</ul>
</section>
<section id="advanced-encryption-standard-aes" class="slide level2">
<h2><span class="r-fit-text">Advanced Encryption Standard (AES)</span></h2>
<ul>
<li>The successor to DES</li>
<li>Has three possible key lengths: 128, 192, and 256</li>
<li>NSA approved this standard, and kept the process open</li>
<li>Also lots of bit-shifting in rounds to encrypt/decrypt a message</li>
<li>Many worry about the security of the standard
<ul>
<li>… that somebody may figure a way to crack it mathematically, in particular</li>
</ul></li>
<li><a href="http://en.wikipedia.org/wiki/Advanced_Encryption_Standard">Reference</a></li>
</ul>
</section>
<section id="public-key-cryptography" class="slide level2">
<h2>Public key cryptography</h2>
<ul>
<li>Everybody has a key that encrypts and a separate key that decrypts
<ul>
<li>They are not interchangeable!</li>
<li>If one key encrypts a message, the <em>only</em> the other key can decrypt it</li>
</ul></li>
<li>The encryption key is made public</li>
<li>The decryption key is kept private</li>
</ul>
</section>
<section id="public-key-cryptography-1" class="slide level2">
<h2>Public key cryptography</h2>
<ul>
<li>Alice (A) wants to send a message to Bob (B)
<ul>
<li>Alice and Bob already have each other’s public keys</li>
</ul></li>
<li>Alice encrypts message <span class="math inline">\(m_1\)</span> with Bob’s public key <span class="math inline">\(B_{pub}\)</span> to create ciphertext <span class="math inline">\(c_1\)</span>
<ul>
<li>She cannot decrypt <span class="math inline">\(c_1\)</span> with <span class="math inline">\(B_{pub}\)</span>
<ul>
<li>Although she likely has a copy of <span class="math inline">\(m_1\)</span></li>
</ul></li>
</ul></li>
<li>Bob decrypts <span class="math inline">\(c_1\)</span> with his private key <span class="math inline">\(B_{pri}\)</span> to get the original <span class="math inline">\(m_1\)</span></li>
<li>Bob encrypts response message <span class="math inline">\(m_2\)</span> with Alice’s public key <span class="math inline">\(A_{pub}\)</span> to create <span class="math inline">\(c_2\)</span></li>
<li>Alice can decrypt <span class="math inline">\(c_2\)</span> with her private key <span class="math inline">\(A_{pri}\)</span> to get the original <span class="math inline">\(m_2\)</span></li>
</ul>
</section>
<section id="public-key-signatures" class="slide level2">
<h2>Public key signatures</h2>
<ul>
<li>What if Alice wants to publish a message publicly, and prove that it really came from her?</li>
<li>She needs to <em>digitally sign</em> the message:
<ul>
<li>Given message <span class="math inline">\(m\)</span>, compute <span class="math inline">\(h = sha256(m)\)</span> using a known hash function such as SHA-256</li>
<li>Encrypt <span class="math inline">\(h\)</span> with her <em>private</em> key <span class="math inline">\(A_{pri}\)</span> to get signature <span class="math inline">\(s\)</span></li>
<li>Publicly release both the message <span class="math inline">\(m\)</span> and the signature <span class="math inline">\(s\)</span></li>
</ul></li>
</ul>
</section>
<section id="public-key-signatures-1" class="slide level2">
<h2>Public key signatures</h2>
<ul>
<li>Now anybody can verify that it came from her:
<ul>
<li>Given public message <span class="math inline">\(m\)</span>, anybody can take the hash of it: <span class="math inline">\(h' = sha256(m)\)</span></li>
<li>Given the signature <span class="math inline">\(s\)</span>, anybody can decrypt it with Alice’s <em>public</em> key <span class="math inline">\(A_{pub}\)</span> to get the original <span class="math inline">\(h\)</span>
<ul>
<li>Recall that <span class="math inline">\(s\)</span> is the encryption of <span class="math inline">\(h\)</span> using <span class="math inline">\(A_{pri}\)</span></li>
<li>If one key encrypts, then the other can decrypt</li>
</ul></li>
<li>If <span class="math inline">\(h == h'\)</span>, then the original message was signed by Alice’s private key</li>
</ul></li>
</ul>
</section>
<section id="public-key-cryptography-math" class="slide level2">
<h2>Public key cryptography math</h2>
<ul>
<li>Public key cryptography uses some type of mathematical theory…
<ul>
<li>… such as prime numbers, elliptic curves, or discrete logs …</li>
</ul></li>
<li>Where some things are “easy” (read: polynomial time)
<ul>
<li>These are the operations used for key generation, encryption, and decryption</li>
<li>Examples: determining if a number is prime, elliptic point multiplication, discrete exponentiation</li>
</ul></li>
<li>And some things are “hard” (read: exponential time)
<ul>
<li>These are the operations needed to “crack” the encryption</li>
<li>Examples: factoring a large composite number, elliptic point division, discrete logs</li>
</ul></li>
</ul>
</section>
<section id="public-key-cryptography-challenges" class="slide level2">
<h2><span class="r-fit-text">Public key cryptography challenges</span></h2>
<ul>
<li>Ensuring you obtain the correct key (not a malicious fake)</li>
<li>Ensuring somebody “in the middle” doesn’t modify your communications</li>
<li>Speed of key generation</li>
<li>Speed of encryption / decryption</li>
<li>Size of the signatures</li>
</ul>
<!-- ============================================================ -->
</section></section>
<section>
<section id="elliptic-curves" class="title-slide slide level1 center">
<h1>Elliptic Curves</h1>

</section>
<section id="elliptic-curves-1" class="slide level2">
<h2>Elliptic Curves</h2>
<p>Any curve of the form <span class="math inline">\(y^2=x^3+ax+b\)</span></p>
<a href="https://en.wikipedia.org/wiki/Elliptic_curve"><img alt="wikipedia elliptic curve diagram" src="images/encryption/EllipticCurveCatalog.svg" style="background-color:white;padding:10px;border-radius:5px"></a>
<aside data-markdown="" class="notes">
notes…
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="specific-elliptic-curves" class="slide level2">
<h2>Specific Elliptic Curves</h2>
<ul>
<li>We are going to study curve <a href="http://www.secg.org/sec2-v2.pdf">secp256k1</a>
<ul>
<li>Where <span class="math inline">\(a=0\)</span> and <span class="math inline">\(b=7\)</span>, so the curve formula is <span class="math inline">\(y^2=x^3+7\)</span></li>
</ul></li>
<li>Operations:
<ul>
<li>Elliptic curve point “addition”: <span class="math inline">\(P = Q \oplus R\)</span></li>
<li>Elliptic curve point “multiplication”: <span class="math inline">\(Q = k \otimes P = kP\)</span>
<ul>
<li>We’ll show that <span class="math inline">\(k \otimes P = \sum_{i=1}^{k}P\)</span>
<ul>
<li>That summation is repeated elliptic curve “addition”</li>
</ul></li>
</ul></li>
<li>Note that numerical values are always lower case variables and points are always upper case variables
<aside data-markdown="" class="notes">
notes…
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside></li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-a.svg" alt="image secp256k1-a.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>note the scale differs on each axis</li>
<li>it reflects across the horizontal (<span class="math inline">\(x\)</span>) axis due to the <span class="math inline">\(y^2\)</span> part</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-q-zoomed-out.svg" alt="image secp256k1-q-zoomed-out.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>just showing it zoomed out</li>
<li>the slope approaches infinity, meaning the line approaches vertical, but not asymptotically</li>
<li>note the different scales – the line is almost vertical at the end</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-r-zoomed-out-with-line.svg" alt="image secp256k1-r-zoomed-out-with-line.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>just trying to show the curvature of the curve</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-a.svg" alt="image secp256k1-a.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>back to the zoomed-in version</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-b-2points.svg" alt="image secp256k1-b-2points.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>arbitrarily picked to allow the math to all work out on the area shown by this slide
<ul>
<li>for each <span class="math inline">\(x\)</span>-value there are two possible <span class="math inline">\(y\)</span> values due to the square root</li>
</ul></li>
<li>in reality, the numbers used are huge: 256 bits
<ul>
<li><span class="math inline">\(2^{256} \approx 1.1*10^{77}\)</span></li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-c-2points-line.svg" alt="image secp256k1-c-2points-line.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>given any two points, use basic arithmetic to compute the slope</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-d-3points-line.svg" alt="image secp256k1-d-3points-line.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>find the third point where this line intersects the curve
<ul>
<li>in the RARE case it doesn’t, pick new points</li>
<li>that chance is infinitesimally small in practice</li>
</ul></li>
<li>for real numbers, this requires finding a cube root
<ul>
<li>we will be able to compute this with basic arithmetic…</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-e-4points-line.svg" alt="image secp256k1-e-4points-line.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>reflect the point just found across the y-axis</li>
<li>the reflected point, C’, is A+B</li>
<li>this is elliptic point “addition”
<ul>
<li>represented with oplus</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-f-point-p.svg" alt="image secp256k1-f-point-p.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>we can add a point to itself as well</li>
<li>this point P is different than A and B from before</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-g-point-p-tangent.svg" alt="image secp256k1-g-point-p-tangent.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>to elliptically add a point to itself, find the tangent of the line…
<ul>
<li>we can do that via the derivative of the curve formula</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-h-points-pq-tangent.svg" alt="image secp256k1-h-points-pq-tangent.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>find the point, Q, where that tangent intersects the curve…</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-i-points-pq-tangent.svg" alt="image secp256k1-i-points-pq-tangent.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>then reflect that across the y-axis</li>
<li>this is P+P and also 2*P</li>
<li>but does adding P to itself, say, 4 times equal 4*P?</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-j-to-find-3p.svg" alt="image secp256k1-j-to-find-3p.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>here we are adding P to Q
<ul>
<li>or P to P+P</li>
<li>or P to 2*P</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-k-to-find-3p.svg" alt="image secp256k1-k-to-find-3p.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>the line intersects the curve at R</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-l-found-3p.svg" alt="image secp256k1-l-found-3p.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>which we reflect across the y-axis</li>
<li>R’ is now P+P+P or 3*P</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-m-showing-found-points.svg" alt="image secp256k1-m-showing-found-points.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>The points from the previous slide without all the text</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-n-associative-1.svg" alt="image secp256k1-n-associative-1.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>we add P and R’ to get S’</li>
<li>S’ is 4*P or P+P+P+P</li>
<li>we can all agree that adding P to itself 4 times yields S’</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-o-associative-2.svg" alt="image secp256k1-o-associative-2.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>we can also add Q’, which is 2*P (or P+P) to itself to yield S’</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-p-associative-3.svg" alt="image secp256k1-p-associative-3.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>this means that adding P to itself k times yields k*P</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section class="slide level2">

<img src="images/encryption/secp256k1/secp256k1-q-point-at-infinity.svg" alt="image secp256k1-q-point-at-infinity.svg" class="stretch">
<aside data-markdown="" class="notes">
<ul>
<li>…</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="the-point-at-infinity" class="slide level2">
<h2>The Point at Infinity</h2>
<ul>
<li>Represented by the digit 0 or capital O</li>
<li>Considered one of the points “on” the curve</li>
<li>Considered the identity element: <span class="math inline">\(0 \oplus P = P\)</span></li>
<li>And <span class="math inline">\(P \oplus P'=0\)</span></li>
</ul>
</section>
<section id="elliptical-curve-notes" class="slide level2">
<h2>Elliptical Curve notes</h2>
<ul>
<li>Most operations were the standard arithmetic operations on scalars
<ul>
<li>Given the <span class="math inline">\(y=mx+b\)</span> formula and an <span class="math inline">\(x\)</span> value, finding the corresponding <span class="math inline">\(y\)</span> is easy</li>
</ul></li>
<li>The only ones that were not were:
<ol type="1">
<li>Finding the initial points using square roots to determine <span class="math inline">\(y\)</span> from <span class="math inline">\(y^2\)</span></li>
<li>Finding the 3rd root of a cubic equation when the other two roots are known</li>
<li>Finding the tangent of an elliptic curve at a point</li>
</ol></li>
<li>We can perform these two with basic arithmetic by:
<ol type="1">
<li>Being <a href="#//secp256k1-curve-base-point">given an initial point on the curve</a></li>
<li>Taking a <a href="#//elliptical-point-addition-1">formulaic shortcut to find the intersection of a line and curve</a></li>
<li>Taking <a href="#//elliptical-point-addition-2">another, different, formulaic shortcut</a></li>
</ol></li>
</ul>
</section>
<section id="elliptical-curve-identities" class="slide level2">
<h2>Elliptical Curve Identities</h2>
<ul>
<li>Multiplication
<ul>
<li>Generalized: <span class="math inline">\(\sum_{i=1}^{k} P = k \otimes P\)</span>
<ul>
<li>Note that the summation operation is EC point <span class="math inline">\(\oplus\)</span>, not scalar <span class="math inline">\(+\)</span></li>
</ul></li>
<li>Example: <span class="math inline">\(P \oplus P \oplus P \oplus P  = 4 \otimes P\)</span></li>
</ul></li>
<li>Notation
<ul>
<li>Generalized: <span class="math inline">\(k \otimes P = kP\)</span></li>
</ul></li>
</ul>
</section>
<section id="elliptical-curve-identities-1" class="slide level2">
<h2>Elliptical Curve Identities</h2>
<ul>
<li>Distributive property
<ul>
<li>Generalized: <span class="math inline">\((a+b) \otimes P = (a \otimes P) \oplus (b \otimes P)\)</span>
<ul>
<li>Due to the order of operations (<span class="math inline">\(\otimes\)</span> before <span class="math inline">\(\oplus\)</span>), we can rewrite that as:</li>
<li><span class="math inline">\((a+b) \otimes P = a \otimes P \oplus b \otimes P\)</span></li>
</ul></li>
<li>Example: <span class="math inline">\((2+2) \otimes P = (2 \otimes P) \oplus (2 \otimes P) = 2P \oplus 2P = 4P\)</span></li>
</ul></li>
<li>Associative property
<ul>
<li><span class="math inline">\(A \oplus B \oplus C = (A \oplus B) \oplus C = A \oplus (B \oplus C)\)</span></li>
</ul></li>
</ul>
<!-- ============================================================ -->
</section></section>
<section>
<section id="finite-fields" class="title-slide slide level1 center">
<h1>Finite Fields</h1>

</section>
<section id="finite-fields-1" class="slide level2">
<h2>Finite Fields</h2>
<div class="right-float-img">
<p><img data-src="https://upload.wikimedia.org/wikipedia/commons/a/a4/Clock_face_one_hand.png"></p>
</div>
<ul>
<li>A <em>field</em> is just a set of numbers that you can perform the basic arithmetic operations on
<ul>
<li>The real numbers are also a field (but not integers!)</li>
</ul></li>
<li>An integer <a href="https://en.wikipedia.org/wiki/Finite_field">finite field</a>:
<ul>
<li>Is defined by a (typically prime) value <span class="math inline">\(p\)</span></li>
<li>All operations are mod <span class="math inline">\(p\)</span></li>
<li>Thus the possible values are the integers <span class="math inline">\(0\)</span> to <span class="math inline">\(p-1\)</span></li>
<li>Denoted as <span class="math inline">\(Z_p\)</span> (and, sometimes, <span class="math inline">\(F_p\)</span>)</li>
</ul></li>
</ul>
<aside data-markdown="" class="notes">
<ul>
<li>a finite field doesn’t have to have a prime <span class="math inline">\(p\)</span>…
<ul>
<li>a clock is (almost) a finite field with a non-prime <span class="math inline">\(p\)</span></li>
<li><em>almost</em> because it’s 1-12, not 0-11</li>
</ul></li>
<li>but for the elliptic curves, we’ll always use a prime <span class="math inline">\(p\)</span> else the math won’t work right</li>
<li>integers are a ring, not a field, as some operations are not valid therein (7/3, for example)</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="finite-field-operations" class="slide level2">
<h2>Finite Field Operations</h2>
<ul>
<li>Operations in <span class="math inline">\(Z_{17}\)</span></li>
<li>Addition: easy – just add the two numbers and mod by <span class="math inline">\(p\)</span>
<ul>
<li><span class="math inline">\(13+25 = 38 \mod 17 = 4\)</span></li>
</ul></li>
<li>Multiplication: easy – just multiply and mod by <span class="math inline">\(p\)</span>
<ul>
<li><span class="math inline">\(6*6 = 36 \mod 17 = 2\)</span></li>
</ul></li>
<li>Exponentiation: easy – just exponentiate and mod by <span class="math inline">\(p\)</span>
<ul>
<li><span class="math inline">\(3^3 = 27 \mod 17 = 10\)</span></li>
<li>There are more efficient ways to do this, discussed later</li>
</ul></li>
</ul>
</section>
<section id="finite-field-subtraction" class="slide level2">
<h2>Finite Field Subtraction</h2>
<ul>
<li>Additive inverse: let <span class="math inline">\(-x\)</span> be defined as <span class="math inline">\(p-x\)</span>
<ul>
<li>Example: <span class="math inline">\(-10=17-10=7\)</span> in <span class="math inline">\(Z_{17}\)</span>
<ul>
<li>Thus the additive inverse of <span class="math inline">\(10\)</span> is <span class="math inline">\(7\)</span> in <span class="math inline">\(Z_{17}\)</span></li>
</ul></li>
<li>Verify:
<ul>
<li><span class="math inline">\(15-10= 5\)</span></li>
<li><span class="math inline">\(15+7=22 \mod 17 = 5\)</span></li>
</ul></li>
</ul></li>
<li>Mod’ing a negative number
<ul>
<li>Keep adding <span class="math inline">\(p\)</span> until it becomes positive</li>
<li>Equivalent: <span class="math inline">\(-x \mod p = p-(x \mod p)\)</span></li>
<li>Example:
<ul>
<li><span class="math inline">\(-23 \mod 17 = -23+17+17=11\)</span></li>
<li><span class="math inline">\(17-(23 \mod 17) = 17-6=11\)</span></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="fermats-little-theorem" class="slide level2">
<h2>Fermat’s Little Theorem</h2>
<ul>
<li>
<p>In <span class="math inline">\(Z_p\)</span>, if <span class="math inline">\(p\)</span> is prime, then <span class="math inline">\(a^p-a\)</span> is a multiple of <span class="math inline">\(p\)</span></p>
<ul>
<li>Rephrased: <span class="math inline">\(a^p-a \mod p = 0\)</span></li>
<li>Rephrased: <span class="math inline">\(a^p \equiv a\)</span> (mod <span class="math inline">\(p\)</span>)</li>
</ul>
</li>
<li class="fragment">
<p>Example in <span class="math inline">\(Z_{7}\)</span>: let <span class="math inline">\(a=2\)</span> and <span class="math inline">\(p=7\)</span></p>
<ul>
<li><span class="math inline">\(a^p-a=2^7-2=128-2=126\)</span></li>
<li><span class="math inline">\(126=7*18\)</span>, so 126 is divisible by 7</li>
</ul>
</li>
<li class="fragment">
<p>Rephrased:</p>
<ul>
<li><span class="math inline">\(a^p \equiv a\)</span> (mod <span class="math inline">\(p\)</span>)</li>
<li><span class="math inline">\(2^7 \equiv 2\)</span> (mod <span class="math inline">\(7\)</span>)</li>
<li>Take the mod of both sides…</li>
<li><span class="math inline">\(128 \mod 7 \equiv 2 \mod 7\)</span></li>
<li><span class="math inline">\(2 \equiv 2\)</span></li>
</ul>
</li>
</ul>
</section>
<section id="finite-field-mult-inverse" class="slide level2">
<h2>Finite Field Mult Inverse</h2>
<ul>
<li>
<p>Fermat’s Little Theorem: <span class="math inline">\(a^p-a \mod p = 0\)</span></p>
</li><li class="fragment">
<p>Divide both sides by <span class="math inline">\(a\)</span>:</p>
<ul>
<li><span class="math inline">\(a^{p-1}-1 \mod p = 0\)</span></li>
</ul>
</li>
<li class="fragment">
<p>Add 1 to both sides:</p>
<ul>
<li><span class="math inline">\(a^{p-1} \mod p = 1\)</span></li>
<li>Example: <span class="math inline">\(2^6 = 64 \mod 7 = 1\)</span></li>
</ul>
</li>
<li class="fragment">
<p>Divide both sides by <span class="math inline">\(a\)</span> again:</p>
<ul>
<li><span class="math inline">\(a^{p-2} \mod p = 1/a\)</span></li>
</ul>
</li>
<li class="fragment">
<p>Re-arrange to get <span class="math inline">\(1/a\)</span>, our multiplicative inverse</p>
<ul>
<li><span class="math inline">\(1/a = a^{-1} = a^{p-2} \mod p\)</span></li>
</ul>
</li>
</ul>
</section>
<section id="finite-field-mult-inverse-1" class="slide level2">
<h2>Finite Field Mult Inverse</h2>
<ul>
<li>To find the multiplicative inverse in <span class="math inline">\(Z_p\)</span>:
<ul>
<li><span class="math inline">\(1/a = a^{-1} = a^{p-2} \mod p\)</span></li>
</ul></li>
<li>Example: <span class="math inline">\(a=13\)</span>, <span class="math inline">\(p=17\)</span>
<ul>
<li><span class="math inline">\(1/13 = 13^{17-2} \mod 17 = 4\)</span></li>
<li>Division by 13 is the same as multiplication by 4 in <span class="math inline">\(Z_{17}\)</span>
<ul>
<li>Or: <span class="math inline">\(x/13 = x \ast 4\)</span> in <span class="math inline">\(Z_{17}\)</span></li>
</ul></li>
<li>Verify: <span class="math inline">\(13*4 = 52 \mod 17 = 1\)</span></li>
</ul></li>
</ul>
</section>
<section id="finite-field-division" class="slide level2">
<h2>Finite Field Division</h2>
<ul>
<li>The multiplicative inverse:
<ul>
<li><span class="math inline">\(1/a = a^{-1} = a^{p-2} \mod p\)</span></li>
</ul></li>
<li>Division is thus:
<ul>
<li><span class="math inline">\(x/a = x*a^{-1} = x \ast a^{p-2} \mod p\)</span></li>
</ul></li>
<li>Example: let <span class="math inline">\(x=13\)</span>, <span class="math inline">\(a=5\)</span>, and <span class="math inline">\(p=17\)</span>
<ul>
<li><span class="math inline">\(13/5 = 13 \ast 5^{17-2} = 13 \ast 5^{15}=6\)</span></li>
<li>Verify: <span class="math inline">\(6*5=30 \mod 17 = 13\)</span></li>
</ul></li>
<li>(<a href="https://eng.paxos.com/blockchain-101-foundational-math">reference</a>)</li>
<li>The net result is that given a value <span class="math inline">\(a\)</span>, we can quickly and easily compute <span class="math inline">\(a^{-1}\)</span></li>
</ul>
</section>
<section id="discrete-elliptic-curves" class="slide level2">
<h2>Discrete Elliptic Curves</h2>
<ul>
<li>We can now perform the four arithmetic operations on a finite field
<ul>
<li>They are “easy” (read: polynomial time)</li>
</ul></li>
<li>The <span class="math inline">\(x\)</span> value is always an integer <span class="math inline">\(0 \le x &lt; p\)</span>
<ul>
<li>For the algorithm we will study, <span class="math inline">\(p=2^{256}-2^{32}-977\)</span>
<ul>
<li>(more on this value later)</li>
</ul></li>
</ul></li>
<li>But we can’t take the square root to determine <span class="math inline">\(y\)</span> from the right side of <span class="math inline">\(y^2=x^3+7\)</span>
<ul>
<li>That’s “hard” (read: exponential time)</li>
</ul></li>
<li>It turns out we don’t need to…</li>
</ul>
</section>
<section id="elliptical-point-addition" class="slide level2">
<h2>Elliptical Point Addition</h2>
<ul>
<li>Adding two (different) points is the same as before:
<ul>
<li>Determine the line equation
<ul>
<li><span class="math inline">\(y=mx+b\)</span> and <span class="math inline">\(m=(y_2-y_1)/(x_2-x_1)\)</span></li>
<li>All these operations are done <em>within the field</em></li>
</ul></li>
<li>Plug it into the equation for the curve: <span class="math inline">\(y^2=x^3+ax+b\)</span>
<ul>
<li>(the <span class="math inline">\(b\)</span> terms on the previous 2 lines are not the same)</li>
</ul></li>
<li><span class="math inline">\((mx+b)^2 = x^3+ax+b\)</span>, then <a href="https://www.calculatorsoup.com/calculators/algebra/cubicequation.php?">solve for the 3 values</a> of <span class="math inline">\(x\)</span>
<ul>
<li>We know <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>, so we need <span class="math inline">\(x_3\)</span></li>
</ul></li>
<li>To determine <span class="math inline">\(y_3\)</span>, use the formula for the line: <span class="math inline">\(y_3=m*x_3+b\)</span></li>
</ul></li>
<li>Problem
<ul>
<li>This requires square roots or cube roots</li>
<li>Hard to do in a field!</li>
</ul></li>
</ul>
</section>
<section id="elliptical-point-addition-1" class="slide level2">
<h2>Elliptical Point Addition</h2>
<ul>
<li>Given two points on the curve: <span class="math inline">\((x_1,y_1)\)</span> and <span class="math inline">\((x_2,y_2)\)</span>
<ul>
<li>Determine the slope: <span class="math inline">\(m=(y_2-y_1)/(x_2-x_1)\)</span></li>
</ul></li>
<li>A shortcut (not derived here) for secp256k1:
<ul>
<li><span class="math inline">\(x_3=m^2-x_1-x_2\)</span></li>
<li><span class="math inline">\(y_3=m(x_1-x_3)-y_1\)</span></li>
</ul></li>
</ul>
</section>
<section id="elliptical-point-addition-2" class="slide level2">
<h2>Elliptical Point Addition</h2>
<ul>
<li>Adding the same point <span class="math inline">\(P\)</span> to itself
<ul>
<li>Curve: <span class="math inline">\(y^2=x^3+7\)</span></li>
<li>Curve: <span class="math inline">\(y= \pm \sqrt{x^3+7}\)</span></li>
<li>Slope is the derivative: <span class="math inline">\(dy/dx = 3x^2/2y\)</span>
<ul>
<li>(<a href="https://github.com/mulllhausen/visual-secp256k1/blob/master/grunt.py">reference</a>, line 92) (or your calculus class)</li>
</ul></li>
</ul></li>
<li>Use the math on the previous slide to determine the resultant point
<ul>
<li>The slope just computed is <span class="math inline">\(m\)</span> on the previous slide</li>
</ul></li>
</ul>
</section>
<section id="elliptical-curve-arithmetic" class="slide level2">
<h2>Elliptical Curve Arithmetic</h2>
<ul>
<li>Given a point <span class="math inline">\(P\)</span> on a curve, you can keep elliptically adding it to itself to get <span class="math inline">\(R=k \otimes P\)</span>
<ul>
<li>Given <span class="math inline">\(k\)</span> and <span class="math inline">\(P\)</span>, it is feasible to determine <span class="math inline">\(R\)</span> – this is “easy”</li>
<li>But given <span class="math inline">\(R\)</span> and <span class="math inline">\(P\)</span>, it is <em>NOT</em> feasible to determine <span class="math inline">\(k\)</span></li>
</ul></li>
<li>Note we can do elliptic curve exponentiation as well:
<ul>
<li>If <span class="math inline">\(k=2^{10}=1024\)</span>, then <span class="math inline">\(R=1024 \otimes P\)</span>, then we can compute that in about 10 steps:
<ul>
<li><span class="math inline">\(P_2 = 2  \otimes  P=P \oplus P\)</span></li>
<li><span class="math inline">\(P_4 = 4  \otimes  P=P_2 \oplus P_2\)</span></li>
<li><span class="math inline">\(P_8 = 8  \otimes  P=P_4 \oplus P_4\)</span></li>
<li>…</li>
<li><span class="math inline">\(R=P_{1024} = 1024 \otimes P =P_{512} \oplus P_{512}\)</span></li>
</ul></li>
</ul></li>
<li>Total steps: <span class="math inline">\(\Theta(\log_2k)\)</span></li>
</ul>
</section>
<section id="reflections-in-a-field" class="slide level2">
<h2>Reflections in a field</h2>
<ul>
<li>A reflection in a field means using the other <span class="math inline">\(y\)</span> value for that <span class="math inline">\(x\)</span>-value
<ul>
<li>The other <span class="math inline">\(y\)</span> value is just <span class="math inline">\(-y\)</span></li>
</ul></li>
<li>Consider secp256k1 with the field <span class="math inline">\(Z_{43}\)</span> (i.e., <span class="math inline">\(p=43\)</span>)</li>
<li>For <span class="math inline">\(x=2\)</span>, there are two <span class="math inline">\(y\)</span> values: 12 and 31
<ul>
<li><span class="math inline">\((12,31) \oplus (29,31) = (2,12)\)</span></li>
<li>It intersects at <span class="math inline">\((2,31)\)</span>, but then reflects to <span class="math inline">\((2,12)\)</span></li>
<li>You can see this <a href="https://andrea.corbellini.name/ecc/interactive/modk-add.html?a=0&amp;b=7&amp;p=43&amp;px=12&amp;py=31&amp;qx=29&amp;qy=31">here</a></li>
</ul></li>
<li>The two <span class="math inline">\(y\)</span> values (here, 12 and 31) will always add to <span class="math inline">\(p\)</span> (here, 43)</li>
<li>The formulas provided herein already handle this reflection</li>
</ul>
</section>
<section id="elliptical-curve-notes-1" class="slide level2">
<h2>Elliptical Curve notes</h2>
<ul>
<li>Even in a finite field, we do not need anything more than the basic arithmetic operations (and exponentiation)
<ul>
<li>Nowhere do we require square root, in particular</li>
<li>Nor a more general discrete log operation</li>
</ul></li>
</ul>
</section>
<section id="relevant-formulas" class="slide level2">
<h2>Relevant formulas</h2>
<ul>
<li>Division in a field <span class="math inline">\(Z_p\)</span>:
<ul>
<li><span class="math inline">\(x/a = x*a^{-1} = x \ast a^{p-2} \mod p\)</span></li>
</ul></li>
<li>Elliptic point addition: given points <span class="math inline">\((x_1,y_1)\)</span> and <span class="math inline">\((x_2,y_2)\)</span>, to find the third point:
<ul>
<li>Determine the slope: <span class="math inline">\(m=(y_2-y_1)/(x_2-x_1)\)</span></li>
<li>Point #3 is <span class="math inline">\((x_3,y_3)\)</span> and determined by:
<ul>
<li><span class="math inline">\(x_3=m^2-x_1-x_2\)</span></li>
<li><span class="math inline">\(y_3=m(x_1-x_3)-y_1\)</span></li>
</ul></li>
</ul></li>
<li>Finding the slope at a point on secp256k1:
<ul>
<li><span class="math inline">\(m=3x^2/2y\)</span></li>
</ul></li>
</ul>
<!-- ============================================================ -->
</section></section>
<section>
<section id="ecdsa" class="title-slide slide level1 center">
<h1>ECDSA</h1>

</section>
<section id="elliptical-curve-cryptography" class="slide level2">
<h2>Elliptical curve cryptography</h2>
<ul>
<li>ECDSA = Elliptic Curve Digital Signature Algorithm</li>
<li>This ECDSA algorithm is specifically to encrypt the <em>signature</em>
<ul>
<li>Meaning the hash of the message</li>
<li>This algorithm is not really used for general purpose cryptography, as the keys are not interchangeable</li>
</ul></li>
</ul>
</section>
<section id="elliptical-curve-cryptography-1" class="slide level2">
<h2>Elliptical curve cryptography</h2>
<ul>
<li>Can use any elliptical curve equation of the form <span class="math inline">\(y^2=x^3+ax+b\)</span></li>
<li>We will use the secp256k1 curve
<ul>
<li>Sets <span class="math inline">\(a=0\)</span> and <span class="math inline">\(b=7\)</span>, so the curve is <span class="math inline">\(y^2=x^3+7\)</span>
<ul>
<li>No <span class="math inline">\(x\)</span> term</li>
</ul></li>
<li>secp256k1 defines a pre-defined <span class="math inline">\(p\)</span> (modulus) value</li>
<li>secp256k1 defines a pre-defined <span class="math inline">\(G\)</span> (base point) value</li>
</ul></li>
</ul>
</section>
<section id="secp256k1" class="slide level2">
<h2>secp256k1</h2>

<img data-src="images/encryption/secp256k1/secp256k1-a.svg" class="r-stretch"></section>
<section id="secp256k1-curve-modulus" class="slide level2">
<h2>secp256k1 curve: modulus</h2>
<ul>
<li>secp256k1 curve: <span class="math inline">\(y^2=x^3+7\)</span></li>
<li><span class="math inline">\(p\)</span> is the prime modulus (the size of the field), and is defined as
<ul>
<li><span class="math inline">\(p=2^{256}-2^{32}-977\)</span></li>
<li><span class="math inline">\(p\)</span> = 0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f</li>
<li><span class="math inline">\(p\)</span> = 115,792,089,237,316,195,423,570,985,008,687,907,853,269,984,665, 640,564,039,457,584,007,908,834,671,663</li>
<li><span class="math inline">\(p \approx 1.16 \ast 10^{77}\)</span></li>
<li>Note that <span class="math inline">\(p\)</span> is 256 bits in size (to match SHA-256)</li>
</ul></li>
<li>Must be prime, and <span class="math inline">\(p\)</span> is</li>
</ul>
</section>
<section id="secp256k1-curve-order" class="slide level2">
<h2>secp256k1 curve: order</h2>
<ul>
<li>secp256k1 curve: <span class="math inline">\(y^2=x^3+7\)</span></li>
<li><span class="math inline">\(o\)</span> is the <em>order</em>, which is the number of points on the curve
<ul>
<li>We include the point at infinity in <span class="math inline">\(o\)</span></li>
<li><span class="math inline">\(o\)</span> = 0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141</li>
<li><span class="math inline">\(o\)</span> = 115,792,089,237,316,195,423,570,985,008,687,907,852,837,564,279, 074,904,382,605,163,141,518,161,494,337</li>
<li><span class="math inline">\(o \approx 1.16 \ast 10^{77}\)</span>, a little less than <span class="math inline">\(p\)</span></li>
</ul></li>
<li><em>SOME</em> modulo operations in ECDSA are with <span class="math inline">\(o\)</span>, not <span class="math inline">\(p\)</span></li>
<li>Also must be prime, and <span class="math inline">\(o\)</span> is</li>
<li>How to determine the order?
<ul>
<li>Count all the points (<em>very</em> slow)</li>
<li><a href="https://en.wikipedia.org/wiki/Schoof%27s_algorithm">Schoof’s algorithm</a>, which takes polynomial time</li>
</ul></li>
</ul>
</section>
<section id="secp256k1-curve-order-1" class="slide level2">
<h2>secp256k1 curve: order</h2>
<ul>
<li>Notation:
<ul>
<li>Most references use <span class="math inline">\(n\)</span> to represent the order</li>
<li>We’ll use <span class="math inline">\(o\)</span></li>
<li>This will lower confusion with one of the elliptic curve computation websites we’ll be using a lot</li>
</ul></li>
</ul>
</section>
<section id="secp256k1-curve-values" class="slide level2">
<h2>secp256k1 curve: values</h2>
<ul>
<li>Why these values?
<ul>
<li>Both <span class="math inline">\(p\)</span> and <span class="math inline">\(o\)</span> are 256 bits (size of a SHA-256 hash)</li>
<li>The modulus, <span class="math inline">\(p\)</span>, is prime</li>
<li>The order, <span class="math inline">\(o\)</span>, is also prime</li>
</ul></li>
<li>We could have used any values for <span class="math inline">\(p\)</span> and <span class="math inline">\(o\)</span> that fulfilled these properties</li>
</ul>
</section>
<section id="secp256k1-curve-base-point" class="slide level2">
<h2>secp256k1 curve: base point</h2>
<ul>
<li>The starting point or “base point” <span class="math inline">\(G\)</span>
<ul>
<li><span class="math inline">\(x\)</span> = 0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F 2815B16F81798
<ul>
<li><span class="math inline">\(x\)</span> = 55,066,263,022,277,343,669,578,718,895,168,534,326,250,603,453,777, 594,175,500,187,360,389,116,729,240</li>
<li><span class="math inline">\(x \approx 5.51 \ast 10^{63}\)</span></li>
</ul></li>
<li>y = 0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C4 7D08FFB10D4B8
<ul>
<li><span class="math inline">\(y\)</span> = 32,670,510,020,758,816,978,083,085,130,507,043,184,471,273,380,659, 243,275,938,904,335,757,337,482,424</li>
<li><span class="math inline">\(y \approx 3.27 \ast 10^{63}\)</span></li>
</ul></li>
</ul></li>
<li><span class="math inline">\(G \approx (5.51 \ast 10^{63}, 3.27 \ast 10^{63})\)</span></li>
<li>How do you think this was determined?</li>
</ul>
</section>
<section id="base-point-properties" class="slide level2">
<h2>Base Point properties</h2>
<ul>
<li>In order for the base point to be able to generate all the points in the range <span class="math inline">\([0,o-1]\)</span>, <span class="math inline">\(G\)</span> needs to lie on the secp256k1 curve</li>
<li>We can verify this in Python (here use use <span class="math inline">\(p\)</span>, not <span class="math inline">\(o\)</span>):</li>
</ul>
<pre class="code-wrapper"><code class="hljs awk small" style="height:auto">$ python3
&gt;&gt;&gt; p = 2**256 - 2**32 - 977
&gt;&gt;&gt; x = 0x79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798
&gt;&gt;&gt; y = 0x483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8
&gt;&gt;&gt; y**2 % p == (x**3 + 7) % p
True
&gt;&gt;&gt; (y**2 - x**3 - 7) % p == 0
True
&gt;&gt;&gt; exit()
$
</code></pre>
</section>
<section id="sec-format-key-encoding" class="slide level2">
<h2>SEC format key encoding</h2>
<ul>
<li>This encoding is for 256-bit (32 byte) keys</li>
<li>Given the base point <span class="math inline">\(G\)</span> = (<span style="color: skyblue">79B…789</span>, <span style="color: pink">483…4B8</span>)</li>
<li>Uncompressed: use prefix ‘04’, then concatenate <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>:
<ul>
<li>04<span style="color: skyblue">779B…789</span><span style="color: pink">483…4B8</span></li>
<li>65 bytes</li>
</ul></li>
<li>Compressed (when we don’t care about the <span class="math inline">\(y\)</span> value):
<ul>
<li>If <span class="math inline">\(y\)</span> is negative (“even”), use prefix ‘02’ and concatenate <span class="math inline">\(x\)</span>:
<ul>
<li>02<span style="color: skyblue">779B…789</span></li>
<li>33 bytes</li>
</ul></li>
<li>If <span class="math inline">\(y\)</span> is positive (“odd”), use prefix ‘03’ and concatenate <span class="math inline">\(x\)</span>:
<ul>
<li>03<span style="color: skyblue">779B…789</span></li>
<li>33 bytes</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="ecdsa-key-generation-setup" class="slide level2">
<h2>ECDSA Key Generation: setup</h2>
<ul>
<li>So we have:
<ul>
<li>Curve parameters <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> (secp256k1: <span class="math inline">\(a=0\)</span> and <span class="math inline">\(b=7\)</span>)</li>
<li>Prime modulus <span class="math inline">\(p\)</span> (secp256k1: <span class="math inline">\(p=2^{256}-2^{32}-977\)</span>)
<ul>
<li>Size is <span class="math inline">\(b\)</span> bits, selected to match the hash size (for us, <span class="math inline">\(b=256\)</span>)</li>
</ul></li>
<li>Curve order <span class="math inline">\(o\)</span> (for secp256k1: <span class="math inline">\(o \approx 1.16 \ast 10^{77}\)</span>)</li>
<li>Base point <span class="math inline">\(G\)</span>; for secp256k1,<br><span class="math inline">\(G \approx (5.51 \ast 10^{63}, 3.27 \ast 10^{63})\)</span></li>
<li>A <span class="math inline">\(b\)</span>-bit hash algorithm that we plan on using
<ul>
<li>It could be any <span class="math inline">\(b\)</span>-bit hash algorithm, but we’ll assume it’s SHA-256 herein</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="ecdsa-key-generation" class="slide level2">
<h2>ECDSA Key Generation</h2>
<ul>
<li>Determine a <span class="math inline">\(b\)</span> bit random number <span class="math inline">\(d\)</span> such that <span class="math inline">\(1 \le d \le o-1\)</span>
<ul>
<li>This is the private key</li>
</ul></li>
<li>Compute point <span class="math inline">\(Q=d \otimes G\)</span>
<ul>
<li>Point <span class="math inline">\(Q\)</span> is the public key</li>
<li>Note that <span class="math inline">\(d\)</span> is a number, but <span class="math inline">\(Q\)</span> is a point</li>
</ul></li>
<li><span class="math inline">\(Q\)</span> is the public key and <span class="math inline">\(d\)</span> is the private key
<ul>
<li>They are not the same – <span class="math inline">\(d\)</span> is a scalar and <span class="math inline">\(Q\)</span> is a point</li>
<li>Thus, they are <em>not</em> interchangeable</li>
</ul></li>
</ul>
<aside data-markdown="" class="notes">
<ul>
<li>private keys are often called ‘d’ because they decrypt
<ul>
<li>although in ECDSA, there isn’t much decryption going on</li>
<li>but it’s still called that anyway…</li>
</ul></li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="signing-an-ecdsa-message" class="slide level2">
<h2>Signing an ECDSA message</h2>
<div class="font-90">
<ul>
<li>Curve parameters:
<ul>
<li><span class="math inline">\(p\)</span>, the prime modulus</li>
<li><span class="math inline">\(o\)</span>, the order of the curve</li>
<li>point <span class="math inline">\(G\)</span>, the base point</li>
</ul></li>
<li>Alice knows:
<ul>
<li><span class="math inline">\(m\)</span>, the message to sign</li>
<li><span class="math inline">\(d\)</span> (or <span class="math inline">\(d_A\)</span>), her private key (secret!)</li>
<li>point <span class="math inline">\(Q\)</span>, her public key</li>
</ul></li>
<li>Alice generates:
<ul>
<li><span class="math inline">\(h\)</span>, the hash of the message <span class="math inline">\(m\)</span> being signed
<ul>
<li>Using a <span class="math inline">\(b\)</span>-bit hash algorithm such as SHA-256</li>
</ul></li>
<li><span class="math inline">\(k\)</span>, a <span class="math inline">\(b\)</span>-bit one time pad (secret!) such that <span class="math inline">\(1 \le k \le o-1\)</span></li>
<li><span class="math inline">\(k^{-1}\)</span>, the (secret) inverse mod-<span class="math inline">\(o\)</span> of <span class="math inline">\(k\)</span> (this is in <span class="math inline">\(Z_o\)</span>, not <span class="math inline">\(Z_p\)</span>)</li>
</ul></li>
</ul>
</div>
<aside data-markdown="" class="notes">
<ul>
<li>because we want to find the multiplicative inverse of <span class="math inline">\(k\)</span>, in order to use Fermat’s little theorem, <span class="math inline">\(o\)</span> must be prime</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="signing-an-ecdsa-message-1" class="slide level2">
<h2>Signing an ECDSA message</h2>
<div class="font-90">
<ul>
<li>Curve parameters: <span class="math inline">\(p\)</span>, <span class="math inline">\(o\)</span>, <span class="math inline">\(G\)</span> (and <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>)</li>
<li>Alice knows: <span class="math inline">\(m\)</span>, <span class="math inline">\(d\)</span>, <span class="math inline">\(Q\)</span></li>
<li>Alice generated: <span class="math inline">\(h\)</span>, <span class="math inline">\(k\)</span>, <span class="math inline">\(k^{-1}\)</span></li>
<li>Alice computes <span class="math inline">\(R=k \otimes G\)</span>
<ul>
<li>Let <span class="math inline">\(r\)</span> be the <span class="math inline">\(x\)</span> component of <span class="math inline">\(R\)</span></li>
</ul></li>
<li>Alice also computes: <span class="math inline">\(s=k^{-1}(h+r*d) \mod o\)</span>
<ul>
<li>This computation used the private key (<span class="math inline">\(d\)</span>), the hash (<span class="math inline">\(h\)</span>), and <span class="math inline">\(r\)</span>
<ul>
<li><span class="math inline">\(r\)</span> needed the the one-time pad <span class="math inline">\(k\)</span> to compute</li>
</ul></li>
</ul></li>
<li>The signature is <span class="math inline">\((r,s)\)</span>
<ul>
<li>Both <span class="math inline">\(r\)</span> and <span class="math inline">\(s\)</span> are <span class="math inline">\(b\)</span> bits in size, so the signature is <span class="math inline">\(2b\)</span> bits</li>
</ul></li>
<li>To verify, we have to show that formula Alice used holds
<ul>
<li><span class="math inline">\(s=k^{-1}(h+r*d) \mod o\)</span></li>
</ul></li>
</ul>
</div>
</section>
<section id="why-those-formulas" class="slide level2">
<h2>Why those formulas?</h2>
<ul>
<li>We want to encode the hash in such a way that:
<ol type="1">
<li>It can NOT be “cracked” in polynomial time</li>
<li>With the public key <span class="math inline">\(Q\)</span>, the formulas can be verified in polynomial time</li>
</ol></li>
<li>Part 1: does “reversing” it take exponential time?
<ul>
<li>We obtain <span class="math inline">\(r\)</span> as the <span class="math inline">\(x\)</span> value of <span class="math inline">\(R=k \otimes G\)</span>
<ul>
<li>Elliptic multiplication is in polynomial time; the reverse (division) would be in exponential time</li>
</ul></li>
<li>We obtain <span class="math inline">\(s\)</span> via <span class="math inline">\(s=k^{-1}(h+r*d) \mod o\)</span>
<ul>
<li>This is a discrete log, so “reversing” this is exponential time</li>
</ul></li>
</ul></li>
<li>Part 2: can it be verified without knowing <span class="math inline">\(d\)</span> (the private key) or <span class="math inline">\(k\)</span> (the secret OTP)
<ul>
<li>Yes; we’ll see this next</li>
</ul></li>
</ul>
</section>
<section id="sanity-checks" class="slide level2">
<h2>Sanity checks</h2>
<ul>
<li>If either <span class="math inline">\(r\)</span> or <span class="math inline">\(s\)</span> are zero, then restart the algorithm
<ul>
<li>Compute a new <span class="math inline">\(k\)</span>, and redo the computations</li>
</ul></li>
<li>This is highly unlikely (although possible!) to occur with the actual values used with secp256k1</li>
<li>But is quite likely to occur with the values we will use in our upcoming homework</li>
</ul>
</section>
<section id="verifying-an-ecdsa-message" class="slide level2">
<h2>Verifying an ECDSA message</h2>
<div class="font-90">
<ul>
<li>Curve parameters: <span class="math inline">\(p\)</span>, <span class="math inline">\(o\)</span>, <span class="math inline">\(G\)</span> (and <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>)</li>
<li>Bob has to verify the message; he knows:
<ul>
<li><span class="math inline">\(m\)</span>, the message whose signature is being checked</li>
<li><span class="math inline">\(Q\)</span>, Alice’s public key</li>
<li><span class="math inline">\((r,s)\)</span>, the signature</li>
</ul></li>
<li>Bob does NOT know:
<ul>
<li><span class="math inline">\(d\)</span>, Alice’s private key</li>
<li><span class="math inline">\(k\)</span>, the one-time pad used</li>
<li><span class="math inline">\(k^{-1}\)</span>, the inverse, mod <span class="math inline">\(o\)</span>, of <span class="math inline">\(k\)</span></li>
</ul></li>
<li>Bob generates:
<ul>
<li><span class="math inline">\(h\)</span>, the hash of the message <span class="math inline">\(m\)</span></li>
<li><span class="math inline">\(s^{-1}\)</span>, the inverse mod-<span class="math inline">\(o\)</span> of <span class="math inline">\(s\)</span> (this is in <span class="math inline">\(Z_o\)</span>, not <span class="math inline">\(Z_p\)</span>)</li>
</ul></li>
</ul>
</div>
</section>
<section id="verifying-an-ecdsa-message-1" class="slide level2">
<h2>Verifying an ECDSA message</h2>
<ul>
<li>Bob has to verify that the following equation holds: <span class="math inline">\(s=k^{-1}(h+r*d) \mod o\)</span>
<ul>
<li>This was the equation Alice computed to determine <span class="math inline">\(s\)</span></li>
<li>He uses his computation of the hash <span class="math inline">\(h\)</span></li>
<li>But he doesn’t know <span class="math inline">\(d\)</span> nor <span class="math inline">\(k\)</span>
<ul>
<li>But recall that <span class="math inline">\(r\)</span> is computed using <span class="math inline">\(k\)</span></li>
<li>And <span class="math inline">\(Q\)</span> was computed using <span class="math inline">\(d\)</span></li>
</ul></li>
</ul></li>
<li>Bob knows: <span class="math inline">\(m\)</span>, <span class="math inline">\(Q\)</span>, <span class="math inline">\((r,s)\)</span>, and the curve parameters
<ul>
<li>Knowing <span class="math inline">\(r\)</span> (the <span class="math inline">\(x\)</span> value of <span class="math inline">\(R\)</span>) implies knowing all of <span class="math inline">\(R\)</span> (the point)</li>
</ul></li>
<li>Bob computes: <span class="math inline">\(h\)</span> and <span class="math inline">\(s^{-1}\)</span></li>
<li>All further steps omit the ‘mod <span class="math inline">\(o\)</span>’ part for clarity</li>
</ul>
</section>
<section id="verifying-an-ecdsa-message-2" class="slide level2">
<h2>Verifying an ECDSA message</h2>
<ul>
<li>
The formula Bob is to verify without <span class="math inline">\(d\)</span>, <span class="math inline">\(k\)</span>, or <span class="math inline">\(k^{-1}\)</span>:<br> <span class="math inline">\(s=k^{-1}(h+r \ast d)\)</span>
</li>
<li class="fragment" data-fragment-index="1">
Multiply both sides by <span class="math inline">\(s^{-1}\)</span>:<br> <span class="math inline">\(1=s^{-1}k^{-1}(h+r \ast d)\)</span>
</li>
<li class="fragment" data-fragment-index="2">
Multiply both sides by <span class="math inline">\(k\)</span>:<br> <span class="math inline">\(k=s^{-1}(h+r \ast d)\)</span>
</li>
<li class="fragment" data-fragment-index="3">
Multiply both sides by <span class="math inline">\(G\)</span>:<br> <span class="math inline">\(k \otimes G=s^{-1}(h+r*d) \otimes G\)</span>
</li>
<li class="fragment" data-fragment-index="4">
Distribute the parenthetical:<br> <span class="math inline">\(k \otimes G = s^{-1} \ast h \otimes G \oplus s^{-1} \ast r \ast d \otimes G\)</span>
</li>
<li class="fragment" data-fragment-index="5">
The public key is defined as <span class="math inline">\(Q = d \otimes G\)</span>:<br> <span class="math inline">\(k \otimes G = s^{-1} \ast h \otimes G \oplus s^{-1} \ast r \otimes Q\)</span>
</li>
</ul>
</section>
<section id="verifying-an-ecdsa-message-3" class="slide level2">
<h2>Verifying an ECDSA message</h2>
<ul>
<li>
The last formula from the previous slide:<br> <span class="math inline">\(k \otimes G = s^{-1} \ast h \otimes G \oplus s^{-1} \ast r \otimes Q\)</span> or:<br><span class="math inline">\(k \otimes G = (s^{-1} \ast h) \otimes G \oplus (s^{-1} \ast r) \otimes Q\)</span>
</li>
<li class="fragment" data-fragment-index="1">
Point <span class="math inline">\(R\)</span> was computed as: <span class="math inline">\(R=k \otimes G\)</span>:<br> <span class="math inline">\(R = s^{-1} \ast h \otimes G \oplus s^{-1} \ast r \otimes Q\)</span>
</li>
<li class="fragment" data-fragment-index="2">
<p>Bob knows:</p>
<ul>
<li><span class="math inline">\(r\)</span>, the <span class="math inline">\(x\)</span> component of <span class="math inline">\(R\)</span>, from the signature</li>
<li><span class="math inline">\(s\)</span> (and computed <span class="math inline">\(s^{-1}\)</span>) from the signature</li>
<li><span class="math inline">\(h\)</span>, the hash value computed from the message <span class="math inline">\(m\)</span></li>
<li><span class="math inline">\(G\)</span>, the base point</li>
<li><span class="math inline">\(Q\)</span>, Alice’s public key</li>
</ul>
</li>
<li class="fragment" data-fragment-index="3">
Bob can now verify that this formula holds!
</li>
</ul>
</section>
<section id="a-note-about-the-math" class="slide level2">
<h2>A note about the math</h2>
<ul>
<li>Given point <span class="math inline">\(P\)</span>, and scalars <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span>, let
<ul>
<li><span class="math inline">\(Q = z \otimes P\)</span></li>
</ul></li>
<li>We have order of operations:
<ul>
<li><span class="math inline">\(x \ast y \ast z \otimes P = (x \ast y \ast z) \otimes P\)</span></li>
</ul></li>
<li>Given:
<ul>
<li><span class="math inline">\(x \ast y \ast d \otimes G\)</span> and <span class="math inline">\(Q = d \otimes G\)</span></li>
<li>We can state: <span class="math inline">\(x \ast y \ast d \otimes G = x \ast  y \otimes Q\)</span></li>
</ul></li>
</ul>
</section>
<section id="when-to-mod-by-o-versus-p" class="slide level2">
<h2>When to mod by <span class="math inline">\(o\)</span> versus <span class="math inline">\(p\)</span></h2>
<div class="font-90">
<ul>
<li><span class="math inline">\(p\)</span> is the prime modulus, <span class="math inline">\(o\)</span> is the order (# of points)</li>
<li>If counting <em>points</em>, we mod by <span class="math inline">\(o\)</span>
<ul>
<li>In EC multiplication</li>
</ul></li>
<li>If checking <em>scalars</em>, we mod by <span class="math inline">\(p\)</span>
<ul>
<li>Does this point lie on the curve?</li>
</ul></li>
<li>Example
<ul>
<li>Let <span class="math inline">\(p=43\)</span> and <span class="math inline">\(o=31\)</span> and consider: <span class="math inline">\(R=50 \otimes G\)</span></li>
<li>As this is counting the number of <em>points</em>, we mod by <span class="math inline">\(o\)</span>, not <span class="math inline">\(p\)</span></li>
<li>So <span class="math inline">\(50 \otimes G = 19 \otimes G\)</span>, but <span class="math inline">\(50 \otimes G \ne 7 \otimes G\)</span></li>
<li>Verify this <a href="https://andrea.corbellini.name/ecc/interactive/modk-mul.html">here</a>
<ul>
<li>Set <span class="math inline">\(a=0\)</span>, <span class="math inline">\(b=7\)</span>, <span class="math inline">\(p=43\)</span>, and let <span class="math inline">\(P=(25,25)\)</span></li>
<li>The resultant point is the same for <span class="math inline">\(o=50\)</span> and <span class="math inline">\(o=19\)</span></li>
<li>But not the same for <span class="math inline">\(o=50\)</span> and <span class="math inline">\(o=7\)</span></li>
</ul></li>
</ul></li>
</ul>
</div>
</section>
<section id="when-to-mod-by-o-versus-p-1" class="slide level2">
<h2>When to mod by <span class="math inline">\(o\)</span> versus <span class="math inline">\(p\)</span></h2>
<ul>
<li>In the signing algorithm, we mod by <span class="math inline">\(o\)</span> (instead of by <span class="math inline">\(p\)</span>):
<ul>
<li>When computing <span class="math inline">\(s=k^{-1}(h+r*d) \mod o\)</span></li>
<li>When computing <span class="math inline">\(k^{-1}\)</span></li>
</ul></li>
<li>In the verification algorithm, we mod by <span class="math inline">\(o\)</span> (instead of by <span class="math inline">\(p\)</span>):
<ul>
<li>When computing <span class="math inline">\(s^{-1}\)</span></li>
</ul></li>
<li>In any elliptic curve multiplication:
<ul>
<li>If computing <span class="math inline">\(R = k \otimes G\)</span>, we can mod <span class="math inline">\(k\)</span> by <span class="math inline">\(o\)</span> to get the same result</li>
</ul></li>
</ul>
</section>
<section id="computing-k-otimes-g" class="slide level2">
<h2>Computing <span class="math inline">\(k \otimes G\)</span></h2>
<div class="font-90">
<ul>
<li>
Let <span class="math inline">\(p=43\)</span>, <span class="math inline">\(o=31\)</span>, <span class="math inline">\(G=(25,25)\)</span>, and <span class="math inline">\(k=21\)</span>
</li>
<li class="fragment">
Compute <span class="math inline">\(21 \otimes G\)</span>
<ul>
<ul>
<li><span class="math inline">\(21 = 10101_b = 2^4+2^2+2^0 = 16+4+1\)</span>
<ul>
<li><span class="math inline">\(21 \otimes G = 16 \otimes G \oplus 4 \otimes G \oplus 1 \otimes G\)</span></li>
</ul></li>
</ul>
</ul>
</li>
<li class="fragment">
Compute the powers of <span class="math inline">\(G\)</span>:
<ul>
<li class="fragment">
<span class="math inline">\(1 \otimes G = G = (25,25)\)</span>
</li>
<li class="fragment">
<span class="math inline">\(2 \otimes G = (1 \otimes G) \oplus (1 \otimes G) = (25,25) \oplus (25,25) = (34,3)\)</span>
</li>
<li class="fragment">
<span class="math inline">\(4 \otimes G = (2 \otimes G) \oplus (2 \otimes G) = (34,3) \oplus (34,3) = (35,21)\)</span>
</li>
<li class="fragment">
<span class="math inline">\(8 \otimes G = (4 \otimes G) \oplus (4 \otimes G) = (35,21) \oplus (35,21) = (29,31)\)</span>
</li>
<li class="fragment">
<span class="math inline">\(16 \otimes G = (8 \otimes G) \oplus (8 \otimes G) = (29,31) \oplus (29,31) = (37,36)\)</span>
</li>
</ul>
</li>
<li class="fragment">
<span class="math inline">\(21 \otimes G = 16 \otimes G \oplus 4 \otimes G \oplus 1 \otimes G\)</span>
<ul>
<li class="fragment">
<span class="math inline">\(21 \otimes G = (37,36) \oplus (35,21) \oplus (25,25)\)</span>
</li>
<li class="fragment">
<span class="math inline">\(21 \otimes G = (38,21) \oplus (25,25) = (32,40)\)</span>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="useful-sites" class="slide level2">
<h2>Useful sites</h2>
<ul>
<li><a href="https://andrea.corbellini.name/2015/05/17/elliptic-curve-cryptography-a-gentle-introduction/">A gentle introduction to elliptic curve cryptography</a>
<ul>
<li>That site has an online <a href="https://andrea.corbellini.name/ecc/interactive/modk-add.html">EC point addition page</a> and <a href="https://andrea.corbellini.name/ecc/interactive/modk-mul.html">EC point multiplication page</a></li>
<li>And also display the points of the field, and tell you the order of the curve</li>
<li>We are using secp256k1, so set <span class="math inline">\(a=0\)</span> and <span class="math inline">\(b=7\)</span></li>
</ul></li>
</ul>
</section>
<section id="why-ecdsa-over-rsa" class="slide level2">
<h2>Why ECDSA over RSA?</h2>
<ul>
<li>ECDSA keys are much quicker to generate</li>
<li>ECDSA encryption &amp; decryption is faster</li>
<li>Cracking a 256-bit ECDSA signature would take about as long as cracking a 3072-bit RSA signature (<a href="https://avinetworks.com/glossary/elliptic-curve-cryptography/">source</a>)
<ul>
<li>Which means the signed message is <em>significantly</em> shorter (256 bits versus 3072 bits) for the same level of security</li>
<li>That’s 1/12th the size!</li>
</ul></li>
<li>ECDSA is really for digital signatures only</li>
</ul>
</section>
<section id="why-rsa-over-ecdsa" class="slide level2">
<h2>Why RSA over ECDSA?</h2>
<ul>
<li>Longer messages don’t have to be broken down into as many parts</li>
<li>Much easier to implement
<ul>
<li>And much easier to implement quickly</li>
</ul></li>
<li>RSA keys are interchangeable; ECDSA keys are not
<ul>
<li>Thus, you cannot use ECDSA for sending encrypted messages back and forth</li>
<li>ECDSA is for digital signatures only</li>
</ul></li>
</ul>
</section>
<section id="security-level" class="slide level2">
<h2>Security Level</h2>
<ul>
<li>A security level of <span class="math inline">\(n\)</span> means that it takes <span class="math inline">\(2^n\)</span> operations to “break” it
<ul>
<li>A means to compare different algorithms</li>
</ul></li>
<li>3072 bit RSA and 256-bit ECDSA have about the same security level (<span class="math inline">\(n=128\)</span>)</li>
<li><a href="https://en.wikipedia.org/wiki/Security_level">Reference</a></li>
</ul>
<!-- ============================================================ -->
</section></section>
<section>
<section id="randomness" class="title-slide slide level1 center">
<h1>Randomness</h1>

</section>
<section id="xkcd-on-randomness" class="slide level2">
<h2>xkcd on randomness</h2>

<img data-src="https://imgs.xkcd.com/comics/random_number.png" style="border:10px solid white" title="RFC 1149.5 specifies 4 as the standard IEEE-vetted random number." class="r-stretch"><div class="r-stack">
<p><a href="https://xkcd.com/221">xkcd # 221</a></p>
</div>
</section>
<section id="computers-and-randomness" class="slide level2">
<h2>Computers and randomness</h2>
<ul>
<li>A computer, by definition, produces the same output for the same input</li>
<li>So how, then, can it produce truly random numbers?</li>
<li>The answer: it can’t
<ul>
<li>We instead generate <a href="https://en.wikipedia.org/wiki/Pseudorandomness"><em>pseudo-random</em> numbers</a></li>
</ul></li>
<li>Pseudorandomness: “A pseudorandom process is a process that appears to be random but is not”
<ul>
<li>That’s all a computer can really generate</li>
</ul></li>
</ul>
</section>
<section id="necessity-of-randomness" class="slide level2">
<h2>Necessity of randomness</h2>
<ul>
<li>Much of encryption depends on randomness</li>
<li>If you could “guess” the random number sequence, then you could figure out the one-time pad
<ul>
<li>… or the generated ssh keys, or the RSA keys…</li>
</ul></li>
<li>So we need really good random numbers</li>
<li>Formally, we need a <a href="https://en.wikipedia.org/wiki/Cryptographically_secure_pseudorandom_number_generator">cryptographically secure pseudorandom number generator</a>
<ul>
<li>Formal definition shortly, but basically, it produces pseudo-random numbers that appear truly random</li>
</ul></li>
</ul>
</section>
<section id="typical-method-lcg" class="slide level2">
<h2>Typical method: LCG</h2>
<ul>
<li>The <a href="https://en.wikipedia.org/wiki/Linear_congruential_generator">linear congruential generator (LCG)</a></li>
<li><span class="math inline">\(X_{n+1}=(a*X_n+c) \text{ mod } m\)</span>
<ul>
<li><span class="math inline">\(m\)</span> is the modulus, and must be positive</li>
<li><span class="math inline">\(a\)</span> is the multiplier: <span class="math inline">\(0 &lt; a &lt; m\)</span></li>
<li><span class="math inline">\(c\)</span> is the increment: <span class="math inline">\(0 &lt; c &lt; m\)</span></li>
<li><span class="math inline">\(X_0\)</span> is the seed value</li>
</ul></li>
<li>libc (C’s <code>rand()</code>) uses <span class="math inline">\(a=1103515245\)</span>, <span class="math inline">\(c=12345\)</span>, and <span class="math inline">\(m=2^{31}\)</span>
<ul>
<li>This will cycle through 2 billion (<span class="math inline">\(2^{31}\)</span>) values before repeating</li>
</ul></li>
<li>With a seed of 1, the initial sequence is:
<ul>
<li>1, 1103527590, 377401575, 662824084, 1147902781, 2035015474, 368800899, …</li>
</ul></li>
</ul>
</section>
<section id="typical-method-example" class="slide level2">
<h2>Typical method: example</h2>
<ul>
<li>Let <span class="math inline">\(m=9\)</span>, <span class="math inline">\(a=4\)</span>, <span class="math inline">\(c=7\)</span></li>
<li>This will cycle through all the values &lt;<span class="math inline">\(m\)</span> before repeating
<ul>
<li>We know that via magic we won’t see here</li>
</ul></li>
<li><span class="math inline">\(X_{n+1}=(a*X_n+c) \text{ mod } m\)</span>
<ul>
<li><span class="math inline">\(X_0 = 1\)</span></li>
<li><span class="math inline">\(X_1 = (4*1+7) \text{ mod } 9 = 2\)</span></li>
<li><span class="math inline">\(X_2 = (4*2+7) \text{ mod } 9 = 6\)</span></li>
<li><span class="math inline">\(X_2 = (4*6+7) \text{ mod } 9 = 4\)</span></li>
<li><span class="math inline">\(X_3 = (4*4+7) \text{ mod } 9 = 5\)</span></li>
<li>Rest of the sequence: 0, 7, 8, 3, and then back to 1</li>
</ul></li>
</ul>
</section>
<section id="typical-method-example-1" class="slide level2">
<h2>Typical method: example</h2>
<ul>
<li>The linear congruential generator (LCG) sequence with <span class="math inline">\(m=9\)</span>, <span class="math inline">\(a=4\)</span>, <span class="math inline">\(c=7\)</span>:
<ul>
<li>1, 2, 6, 4, 5, 0, 7, 8, 3, and then back to 1</li>
</ul></li>
<li>But where to start in the sequence?
<ul>
<li>We could start anywhere therein</li>
</ul></li>
<li>Where we start is called the <em>seed</em></li>
<li>Different seed values just start at a different spot in the cycle of random numbers</li>
</ul>
</section>
<section id="what-seed-to-use" class="slide level2">
<h2>What seed to use?</h2>
<ul>
<li>If you use the same seed, you will always get the same random sequence</li>
<li>Many people use <code>time(NULL)</code> in C/C++
<ul>
<li>This is the current number of seconds since January 1st, 1970</li>
<li>Which is how UNIX systems keep track of time</li>
</ul></li>
<li>But if you run the program twice in the same second, it will use the same sequence!</li>
<li>That being said, this is probably sufficient for non-cryptographic purposes
<ul>
<li>You could use the current time in milliseconds…</li>
</ul></li>
</ul>
</section>
<section id="csprng-requirements" class="slide level2">
<h2>CSPRNG Requirements</h2>
<ul>
<li>CSPRNG = Cryptographically Secure Pseudo-Random Number Generator</li>
<li>A CSPRNG needs:
<ul>
<li>A good source of entropy for the seed
<ul>
<li>Should appear random</li>
</ul></li>
<li>Enough entropy to have an good initial seed</li>
<li>A good algorithm whose output appears to be unpredictable</li>
</ul></li>
</ul>
</section>
<section id="why-libc-is-not-cryptographically-secure" class="slide level2">
<h2><span class="r-fit-text">Why libc is not cryptographically secure</span></h2>
<ul>
<li>The seed can be only one of <span class="math inline">\(2^{31} \approx 2.1\)</span> billion values</li>
<li>One can generate all 2.1 billion! On a modern computer:
<ul>
<li>A 2048-bit RSA key takes less than 0.1 seconds to generate
<ul>
<li>To compute all 2.1 billion: 6.5 years</li>
</ul></li>
<li>A 256-bit ECDSA key takes less than 0.005 seconds to generate
<ul>
<li>1/20th of the time!</li>
<li>To compute all 2.1 billion: 3.5 months</li>
</ul></li>
</ul></li>
<li>Much faster on a parallel computer or a GPU…</li>
</ul>
</section>
<section id="csprng-entropy-sources" class="slide level2">
<h2>CSPRNG: Entropy sources</h2>
<ul>
<li>Linux accumulates entropy in /dev/random &amp; /dev/urandom from:
<ul>
<li>“environmental noise from device drivers and other sources”</li>
<li>Various timings of things at boot-up time, as there are always small variances between boots</li>
<li>Various sensors, such as the CPU temperature sensor or the fan speed sensor</li>
<li>User interaction (keyboard timings, etc.)</li>
<li>Physical devices designed for this exact purpose</li>
</ul></li>
<li>Reads from /dev/urandom never block; /dev/random will block until enough entropy is present
<ul>
<li>/dev/urandom is much better…</li>
</ul></li>
</ul>
</section>
<section id="use-more-entropy" class="slide level2">
<h2>Use more entropy</h2>
<ul>
<li>Essentially, have more bits in the seed</li>
<li>Typical cryptocurrency solution: use 128 bits
<ul>
<li>That’s <span class="math inline">\(2^{128}=3.4*10^{38}\)</span> possible keys</li>
<li>Computing that many ECDSA keys would take <span class="math inline">\(4.6*10^{28}\)</span> years</li>
</ul></li>
<li>Some use 256 bits (<span class="math inline">\(1.1 \ast 10^{77}\)</span> ECDSA keys, <span class="math inline">\(1.6 \ast 10^{67}\)</span> years to generate all)</li>
<li>Problem: how to allow the owner to remember 128 (or 256) bits of entropy?
<ul>
<li>That’s a 16 byte (32 digit) hex number</li>
<li>For 256-bit keys, that’s a 32 byte (64 digit) hex number</li>
</ul></li>
</ul>
</section>
<section id="remembering-your-seed" class="slide level2">
<h2>Remembering your seed</h2>
<ul>
<li>Imagine a list of <span class="math inline">\(2048=2^{11}\)</span> words
<ul>
<li>Each word thus provides 11 bits of entropy</li>
</ul></li>
<li>Generate a list of 12 of these words
<ul>
<li><span class="math inline">\(11 \ast 12=132\)</span>; use the last 4 bits as a checksum</li>
</ul></li>
<li>Or a list of 24 of them (264 bits =&gt; 256 bit seed)</li>
<li>List is defined in <a href="https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki">BIP39</a>
<ul>
<li>Different versions for different languages including the <a href="https://github.com/bitcoin/bips/blob/master/bip-0039/english.txt">English list</a></li>
<li>Implementations in various programming languages are provided as well</li>
</ul></li>
</ul>
</section>
<section id="seed-phrases" class="slide level2">
<h2>Seed phrases</h2>
<ul>
<li>Most cryptocurrency wallets use these</li>
<li>It only works if the algorithm to compute the keys for the given cryptocurrency is repeatable with the same seed!</li>
<li>Then this phrase can be used to re-generate your keys</li>
<li>And you can store it in a device like <a href="https://www.amazon.com/dp/B07RZW8CWY">this</a></li>
</ul>
</section>
<section id="cloudflare-uses-a-wall-of-lava-lamps-source" class="slide level2">
<h2>Cloudflare uses a wall of lava lamps (<a href="https://it.slashdot.org/story/17/11/07/1927239/how-cloudflare-uses-lava-lamps-to-encrypt-the-internet">source</a>)</h2>

<img src="http://blog.cloudflare.com/content/images/2017/11/lava-lamps.jpg" style="padding:0" class="r-stretch"></section>
<section id="csprng-algorithms" class="slide level2">
<h2>CSPRNG: Algorithms</h2>
<ul>
<li>Cryptographic primitives: ciphertext bytes, hash results, etc.</li>
<li>Number-theoretic designs: mathematical concepts that turned out to be good for this</li>
<li>Special designs: algorithms designed for this specific purpose</li>
<li>See <a href="https://en.wikipedia.org/wiki/Cryptographically-secure_pseudorandom_number_generator#Designs">here</a> for a fuller list</li>
</ul>
</section>
<section id="determining-randomness" class="slide level2">
<h2>Determining randomness</h2>
<ul>
<li>To tell if a number sequence is truly (pseudo-) random, you run <a href="https://en.wikipedia.org/wiki/Randomness_tests">randomness tests</a> on it</li>
<li>Examples:
<ul>
<li>Run it a bagillion times and see if the distributions of the numbers is uniform across the range</li>
<li>See if the numbers follow a <a href="https://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a> (when run through the correct formulas)</li>
<li>Interpret the numbers as 5 card stud poker hands, and see if the distrubtion of hands is the expected distribution</li>
<li>And many others…</li>
</ul></li>
</ul>
</section>
<section id="security" class="slide level2">
<h2>Security</h2>

<img data-src="https://imgs.xkcd.com/comics/security.png" style="border:10px solid white" title="Actual actual reality: nobody cares about his secrets.  (Also, I would be hard-pressed to find that wrench for $5.)" class="r-stretch"><div class="r-stack">
<p><a href="https://xkcd.com/538">xkcd # 538</a></p>
</div>
<!-- ============================================================ -->
</section></section>
<section>
<section id="hashing" class="title-slide slide level1 center">
<h1>Hashing</h1>

</section>
<section id="terminology" class="slide level2">
<h2>Terminology</h2>
<ul>
<li>Message Digest == Secure Hash
<ul>
<li>The former is an older term, the latter is what is currently used</li>
<li>It’s just a hash with the algorithm described herein…</li>
</ul></li>
</ul>
</section>
<section id="ensuring-the-download-is-correct" class="slide level2">
<h2><span class="r-fit-text">Ensuring the download is correct…</span></h2>
<ul>
<li>What if we don’t want to encrypt the data?
<ul>
<li>So anybody can download it: patches, open source code, etc.</li>
<li>But we want to be sure to allow those people to verify that they downloaded the correct file
<ul>
<li>And that they didn’t have any download errors</li>
</ul></li>
</ul></li>
<li>Solution: provide a hash code of the file</li>
</ul>
</section>
<section id="hashing-properties" class="slide level2">
<h2>Hashing properties</h2>
<ul>
<li>Hash goals:
<ul>
<li>Changing even a single bit has a dramatic effect on the hash code</li>
</ul></li>
<li>Pigeon hole principle:
<ul>
<li>If we use a 128-bit hash, that yields <span class="math inline">\(2^{128} \approx 3.4 \ast 10^{38}\)</span> possible values</li>
<li>If we have files that are 129+ bits, then there will be more possible files than there are hashes</li>
<li>Thus, multiple files will provide the same hash</li>
<li>This will hold for <em>all</em> hashes, as long as the hash code is of a finite length</li>
</ul></li>
</ul>
</section>
<section id="hash-vulnerabilities" class="slide level2">
<h2>Hash vulnerabilities</h2>
<ul>
<li>For a hash function to be really vulnerable, we want to be able to take an <em>arbitrary</em> text and make it match the desired hash code
<ul>
<li>Sender sends: “deposit $1 million into account 12345” with hash “abcdefg”</li>
<li>You intercept and send a new message: “deposit $1 million into account 67890; <em>(fl</em>_0” with hash “abcdefg”
<ul>
<li>The trailing “; <em>(fl</em>_0” allowed the different document to match the same hash</li>
</ul></li>
</ul></li>
<li>Being able to create two “random” files that match the same hash indicates a weakness, but is not yet a vulnerability</li>
</ul>
</section>
<section id="hashes-are-one-way" class="slide level2">
<h2>Hashes are one-way!</h2>
<ul>
<li>Consider the following two files:
<ul>
<li>(from <a href="https://stackoverflow.com/questions/26217076/example-of-hash-collision-printable-strings">here</a>, as it may not render properly on the slides)</li>
</ul>
<pre><code>1i=\/ʵF~@X&gt;U4 䈃%qAZQ%ɟ7&lt;[؂&gt;1V4[m6Sⴇ9cH͠3BW~Tp
Ƙ!e+o*p</code></pre>
<pre><code>1i=\/ʵF~@X&gt;U4    䈃%AZQ%ɟr7&lt;[؂&gt;1V4[m6S49cH͠3BW~Tp(
Ƙ!eo*p</code></pre></li>
<li>The both have the same MD5 hash of 79054025255fb1a26e4bc422aef54eb4</li>
<li>So given the MD5 hash, how do we know which one it came from?</li>
</ul>
</section>
<section id="pigeonhole-principle" class="slide level2">
<h2>Pigeonhole principle</h2>
<ul>
<li>An MD5 hash is 128 bits; SHA hashes go up to 512 bits</li>
<li>There are more files possibilities of 129 bits (or 513 bits) than there are possible hashes</li>
<li>Thus, as per the pigeonhole principle, there will be multiple inputs for a given hash</li>
<li>So how do you know how to go <em>back</em> from a hash?
<ul>
<li>Answer: you don’t</li>
</ul></li>
</ul>
</section>
<section id="collision-resistant-hashes" class="slide level2">
<h2>Collision resistant hashes</h2>
<ul>
<li>A <em>collision resistant hash</em> means that it is “hard” to find two inputs that hash to the same value
<ul>
<li>Harder than, say, brute force</li>
<li>If there is any way easier than brute force, that’s bad</li>
</ul></li>
</ul>
</section>
<section id="collision-resistant-hashes-1" class="slide level2">
<h2>Collision resistant hashes</h2>
<ul>
<li>Due to the birthday paradox, one will typically have to brute force <span class="math inline">\(2^{n/2}\)</span> attempted values before a collision is found
<ul>
<li>For MD5 (128 bits): <span class="math inline">\(2^{128/2} = 2^{64} = 1.84 \ast 10^{19}\)</span> attempts
<ul>
<li>Computing 1 million a second takes <span class="math inline">\(5.85 \ast 10^{11}\)</span> years</li>
<li>But a better attack can achieve this in under a minute</li>
<li>(MD5 is <em>not</em> collision resistant, as described later)</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="collision-resistant-hashes-2" class="slide level2">
<h2>Collision resistant hashes</h2>
<ul>
<li>For SHA-256 (256 bits): <span class="math inline">\(2^{256/2} = 2^{128} = 3.40 \ast 10^{38}\)</span> attempts
<ul>
<li>Computing 1 million a second takes <span class="math inline">\(1.08 \ast 10^{31}\)</span> years</li>
</ul></li>
<li><a href="http://en.wikipedia.org/wiki/Collision_resistant">reference</a></li>
</ul>
</section>
<section id="crc32-cyclic-redundancy-check" class="slide level2">
<h2><a href="http://en.wikipedia.org/wiki/Crc32">CRC32: Cyclic Redundancy Check</a></h2>
<ul>
<li>The hash value is a 32-bit integer
<ul>
<li>There are variants of other bits: 16, 64, etc.</li>
</ul></li>
<li>Is used for downloading files (via modem, download program, etc.) – i.e.&nbsp;as a checksum
<ul>
<li>It works great for this purpose</li>
</ul></li>
<li>With the (simple) math behind the checksum, and “only” 4 billion possibilities, one can target a specific CRC 32 hash value</li>
</ul>
</section>
<section id="md5-message-digest-5" class="slide level2">
<h2>MD5: Message Digest 5</h2>
<ul>
<li>Produces a 128-bit value (<span class="math inline">\(3.4 \ast 10^{38}\)</span> possible values)
<ul>
<li>Expressed as a 32-digit hex number</li>
</ul></li>
<li>It used to be the most widely used algorithm</li>
<li>Designed in 1991 when research indicated its predecessor (MD4) was insecure</li>
<li>Printed in hex:</li>
</ul>
<pre><code>$ md5sum message1.txt 
afe68f753a65f773a591bcf6f9ce3c63  message1.txt</code></pre>
<ul>
<li>Still sometimes used for file downloading
<ul>
<li>CERT: “should be considered cryptographically broken and unsuitable for further use”</li>
</ul></li>
</ul>
</section>
<section id="sha-0-and-sha-1" class="slide level2">
<h2>SHA-0 and SHA-1</h2>
<ul>
<li>Designed by the NSA
<ul>
<li>After the DES debacle, it’s become an open standard</li>
<li>Published by NIST (National Institute of Standards and Technology)</li>
</ul></li>
<li>160 bit hash</li>
<li>SHA-0 (1993): had a flaw, was quickly corrected
<ul>
<li>The flaw introduced an unintended weakness</li>
</ul></li>
<li>SHA-1 (1995): fixed that flaw, was very widely used for security applications
<ul>
<li>But typically not for downloading files</li>
</ul></li>
</ul>
</section>
<section id="sha-0-and-sha-1-1" class="slide level2">
<h2>SHA-0 and SHA-1</h2>
<ul>
<li>In 2005, security flaws were discovered in SHA-1
<ul>
<li>A vulnerability has not been shown, however</li>
<li><a href="http://en.wikipedia.org/wiki/Sha-1">reference</a></li>
</ul></li>
</ul>
</section>
<section id="sha-2" class="slide level2">
<h2><a href="http://en.wikipedia.org/wiki/SHA-2">SHA-2</a></h2>
<ul>
<li>Designed in 2001 to address the flaw discovered in SHA-1
<ul>
<li>There are 4 variants, depending on the length of key desired: SHA-224, SHA-256, SHA-384, SHA-512</li>
</ul></li>
<li>SHA-2 is mathematically similar (but not identical!) to SHA-1
<ul>
<li>So if there are vulnerabilities in SHA-1, do they exist in SHA-2?</li>
<li>Nobody knows, but this lead to the development of SHA-3</li>
</ul></li>
<li>Most US gov’t applications require a SHA-2 hash</li>
<li>See the pseudocode <a href="https://en.wikipedia.org/wiki/SHA-2#Pseudocode">here</a></li>
</ul>
</section>
<section id="sha-3" class="slide level2">
<h2><a href="http://en.wikipedia.org/wiki/SHA-3">SHA-3</a></h2>
<ul>
<li>Intent is for it NOT to derive (or be similar to) SHA-2
<ul>
<li>So if the SHA-1 vulnerability exists in SHA-2, it thus will not affect SHA-3</li>
</ul></li>
<li>NIST (National Institute for Standards and Technology) had an open solicitation / compettion for the algorithm
<ul>
<li>The particular one selected was <a href="https://en.wikipedia.org/wiki/SHA-3">Keccak</a></li>
</ul></li>
</ul>
</section>
<section id="storing-passwords" class="slide level2">
<h2>Storing passwords</h2>
<ul>
<li>No (secure) system stores user passwords in plaintext</li>
<li>Instead it stores a <em>hash</em> of those passwords
<ul>
<li>On login, it hashes your attempt, and then compares the hashes</li>
<li>Thus, there could be <em>multiple</em> passwords that would log you in</li>
</ul></li>
<li>This leads to vulnerabilities…</li>
</ul>
</section>
<section id="dictionary-attacks" class="slide level2">
<h2>Dictionary attacks</h2>
<ul>
<li>To perform a <a href="https://en.wikipedia.org/wiki/Dictionary_attack">dictionary attack</a>:
<ul>
<li>Take every hashed password for a given system</li>
<li>Take every word in the English language, and hash it</li>
<li>Find the intersection of those, and you have a bunch of passwords</li>
</ul></li>
</ul>
</section>
<section id="rainbow-tables" class="slide level2">
<h2>Rainbow tables</h2>
<ul>
<li>A <a href="https://en.wikipedia.org/wiki/Rainbow_table">rainbow table</a> is a pre-computed list of all hashed passwords
<ul>
<li><a href="https://md5hashing.net/hash/md5/5f4dcc3b5aa765d61d8327deb882cf99">Here</a> is the one for ‘password’</li>
</ul></li>
<li>They are searchable (by hash) via Google</li>
</ul>
</section>
<section id="password-salting" class="slide level2">
<h2>Password Salting</h2>
<ul>
<li>To prevent dictionary attacks, and limit the usefulness of rainbow tables, passwords are <em>salted</em></li>
<li>Each password is given a random number, or salt, which is added to the hash</li>
<li>Normally, ‘password’ has MD5 hash of 5f4dcc3b5aa765d61d8327deb882cf99</li>
<li>Adding a random salt: ‘password935723798539’ has MD5 hash of 80d2b285e1d5e9b3078383a2e96074bf
<ul>
<li>With a reasonable size salt, rainbow tables and dictionary attacks are of less use due to the search space size</li>
</ul></li>
</ul>
</section>
<section id="hashes-well-see" class="slide level2">
<h2>Hashes we’ll see</h2>
<ul>
<li>SHA2
<ul>
<li>Different lengths: SHA-224, SHA-256, SHA-384, SHA-512</li>
<li>Consider the <a href="https://en.wikipedia.org/wiki/SHA-2#Pseudocode">SHA-256 pseudocode from Wikipedia</a>
<ul>
<li>It’s not magic!</li>
</ul></li>
<li>Used in Bitcoin</li>
</ul></li>
<li><a href="https://en.wikipedia.org/wiki/RIPEMD">RIPEMD-160</a>
<ul>
<li>160-bit hash</li>
<li>Used in Bitcoin</li>
</ul></li>
<li>Keccak-256, aka SHA-3
<ul>
<li>Used in Ethereum</li>
</ul></li>
<li>Falcon-512
<ul>
<li>A finalist for NIST’s <a href="https://csrc.nist.gov/projects/post-quantum-cryptography">Post-Quantum Cryptography</a></li>
</ul></li>
</ul>
</section>
<section id="calling-sha-256-in-c" class="slide level2">
<h2>Calling SHA-256 in C</h2>
<p>From <a href="https://rosettacode.org/wiki/SHA-256">rossettacode.org</a>; compile with <code>-lssl -lcrypto</code>:</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;openssl/sha.h&gt;
 
int main (void) {
  const char *s = "Rosetta code";
  unsigned char *d = SHA256(s, strlen(s), 0);
 
  int i;
  for (i = 0; i &lt; SHA256_DIGEST_LENGTH; i++)
    printf("%02x", d[i]);
  putchar('\n');
 
  return 0;
}</code></pre>
</section>
<section id="calling-sha-256-in-python-java" class="slide level2">
<h2>Calling SHA-256 in Python &amp; Java</h2>
<p>From <a href="https://rosettacode.org/wiki/SHA-256">rossettacode.org</a> – just call <code>hashlib.sha256()</code>:</p>
<pre class="code-wrapper"><code class="hljs awk small" style="height:auto">&gt;&gt;&gt; import hashlib
&gt;&gt;&gt; hashlib.sha256( "Rosetta code".encode() ).hexdigest()
'764faf5c61ac315f1497f9dfa542713965b785e5cc2f707d6468d7d1124cdfcf'
&gt;&gt;&gt; 
</code></pre>
<p>For Java, see <a href="https://rosettacode.org/wiki/MD5#Java">here</a>, but change <code>MD5</code> to <code>SHA-256</code> (<a href="https://rosettacode.org/wiki/SHA-256#Java">reference</a>)</p>
</section>
<section id="calling-sha-256-from-the-command-line" class="slide level2">
<h2><span class="r-fit-text">Calling SHA-256 from the command line</span></h2>
<pre class="code-wrapper" style="width:95%;margin-left:0"><code class="hljs awk small" style="height:auto">$ sha256sum lorem-ipsum.txt 
32e7ac08ab60eff44f6f69fcb3ef45713bfdf3338d4e62a725e451f8f0b08eef  lorem-ipsum.txt
$
</code></pre>
<!-- ============================================================ -->
</section></section>
<section>
<section id="applied-cryptography" class="title-slide slide level1 center">
<h1>Applied Cryptography</h1>

</section>
<section id="openssl-to-generate-a-rsa-key" class="slide level2">
<h2>Openssl to generate a RSA Key</h2>
<pre><code>$ openssl genpkey -algorithm RSA \
    -pkeyopt rsa_keygen_bits:2048 \
    -out key.pem
....+++++
....+++++
$</code></pre>
</section>
<section id="pem-key-file-format" class="slide level2">
<h2>PEM key file format</h2>
<pre class="code-wrapper"><code class="hljs awk small" style="height:auto">$ cat key.pem
-----BEGIN PRIVATE KEY-----
MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDKmfQPMEZiho43
7rYfHB6bXDW1aQWrSJLlufEB23akwgyiHI85XcejJ10prWGU8aJA4VW8UJ1e6EZu
m0LFln1LCEZJX1Os/H9zR2OxV52Xd+/U5ooy+nxg9VfBwUOcEx6gmNfQu06zLDuf
cyKWXkF3DOE7rlPSq1xLk0GxYq+VvQEexMphMswdIiqcx4swdDWdA7x7z/nX6opx
TDp+tY3M/QIJVh6mn1MvIbhc+PDLQRvEi1ZhMiAgk69LkA32gxXFaSU+x5Cl44dH
69SJX3Z3xVhy/dpRpac9yEf/iVbSyV9z7as2qcD7PEfa3vIiQ+5o1O3O0jG40d8T
bxCsPe7TAgMBAAECggEBAJ3AVBWDfDp5FMGeYDZG+dn0aWlwddaRcrfnGS5eCLpu
0dFkNWzwhWKXYuXxt3p2zuR/z/cKOg7NAxJaWBpre/FxZvD4hbm6/S3wl0JduzpW
S+rU+ySIf1IrloIqDo+3H3DisaA4SCYguegEiRjWGVkuMS38Jg5yGTJLXapV8eu/
VGetSD7o6icG3QUs44NUOgoDPJeM41WpndgqPl558p6Y0wo48o08GBnQ7eAn+ERW
06JBeQ70/lrsj0RbkJdBqou17O2fpTJW0MM4fEWa9c8DCWmQIIS2R17sZNIT2/i1
9hnMWnvu5N+cIU53zefpskzmv6VdDLa0o1prqvvmlEECgYEA87t8HnvI1RzSvJUe
+/Knioe2PK9Ebd6HMJjNPhzuHOGjSDVbxMmBmDuxFgA7ia/PRGQLKUPcqlMBEJo+
C8t7gyAa5v8kJFvn8Y1+gdRkVqV/g7yV8Bes/0ZbDNzHra4vOVzkIO+gopy/9/Iz
CmSBP56p4/VUV5MC4l6OeTTHJPMCgYEA1Mx955btDWa8vqJJCsXcNp+Av1J9dI2e
T3Jx2/7ETNTCAD98r/2PryboHq1R20DqE/lTWE06gOphHl1OOyoR8YaV7zT0bzlP
4DoTvxamp7Xah8mgnnG0FjGSclKeMSeFsQAIfX+VJGqw+8UWTHgVsu+B8OQCHQ1n
wIZ3mp/WBqECgYAqhAHar20Q/74i90A4YtOm7pVzcH9XSwH6EC19MD64+wMojWY8
pYndrEvvsoqwMeLN40WvJQ9RBrmg08cO96fL78XBlbAQR5fmIvB2ZT47fxMHP9ZH
01lyDivDyp9qRIAoWXPR6vryYrV54t3UakPBfUPVZ+4WeKaAJk5kBjjW0QKBgQCb
19ctUD7zXZZFFpzfouAPsOidNVBjl4OlM29nakFg8z/Q5q3uRYiBAcFlFhGovPWx
Axuiw4xg9UWC81pjwf+6HpKXyPRqsFJrKJ1liLUsheYxI9zZrPPyfQN/bjokTYl/
g0K0hkc3kFtlR4V5I0jg7r7/KDzUAglF2jSlrQEVgQKBgQCVbKjqCbDzTIrct8jQ
xVrEpND1JcnyQoAdBIi8Lf8ffVpCxBhOBklJhhXqjaZ8iE7nS7xWfDOR2Jm0RUu0
3KpnWcKQz7MCGjkXVWrm412T1lrnp2UlD0MhqLps27NUJ6bybr200kwHxJcrZLb0
p4ZuGFwSn9QTFdGG3Y/OPRGWhg==
-----END PRIVATE KEY-----
$

</code>
</pre>
</section>
<section id="openssl-to-view-a-rsa-key" class="slide level2">
<h2>OpenSSL to view a RSA Key</h2>
<pre class="code-wrapper"><code class="hljs awk small" style="height:600px">$ openssl rsa -in key.pem -text -noout
RSA Private-Key: (2048 bit, 2 primes)
modulus:
    00:ca:99:f4:0f:30:46:62:86:8e:37:ee:b6:1f:1c:
    1e:9b:5c:35:b5:69:05:ab:48:92:e5:b9:f1:01:db:
    76:a4:c2:0c:a2:1c:8f:39:5d:c7:a3:27:5d:29:ad:
    61:94:f1:a2:40:e1:55:bc:50:9d:5e:e8:46:6e:9b:
    42:c5:96:7d:4b:08:46:49:5f:53:ac:fc:7f:73:47:
    63:b1:57:9d:97:77:ef:d4:e6:8a:32:fa:7c:60:f5:
    57:c1:c1:43:9c:13:1e:a0:98:d7:d0:bb:4e:b3:2c:
    3b:9f:73:22:96:5e:41:77:0c:e1:3b:ae:53:d2:ab:
    5c:4b:93:41:b1:62:af:95:bd:01:1e:c4:ca:61:32:
    cc:1d:22:2a:9c:c7:8b:30:74:35:9d:03:bc:7b:cf:
    f9:d7:ea:8a:71:4c:3a:7e:b5:8d:cc:fd:02:09:56:
    1e:a6:9f:53:2f:21:b8:5c:f8:f0:cb:41:1b:c4:8b:
    56:61:32:20:20:93:af:4b:90:0d:f6:83:15:c5:69:
    25:3e:c7:90:a5:e3:87:47:eb:d4:89:5f:76:77:c5:
    58:72:fd:da:51:a5:a7:3d:c8:47:ff:89:56:d2:c9:
    5f:73:ed:ab:36:a9:c0:fb:3c:47:da:de:f2:22:43:
    ee:68:d4:ed:ce:d2:31:b8:d1:df:13:6f:10:ac:3d:
    ee:d3
publicExponent: 65537 (0x10001)
privateExponent:
    00:9d:c0:54:15:83:7c:3a:79:14:c1:9e:60:36:46:
    f9:d9:f4:69:69:70:75:d6:91:72:b7:e7:19:2e:5e:
    08:ba:6e:d1:d1:64:35:6c:f0:85:62:97:62:e5:f1:
    b7:7a:76:ce:e4:7f:cf:f7:0a:3a:0e:cd:03:12:5a:
    58:1a:6b:7b:f1:71:66:f0:f8:85:b9:ba:fd:2d:f0:
    97:42:5d:bb:3a:56:4b:ea:d4:fb:24:88:7f:52:2b:
    96:82:2a:0e:8f:b7:1f:70:e2:b1:a0:38:48:26:20:
    b9:e8:04:89:18:d6:19:59:2e:31:2d:fc:26:0e:72:
    19:32:4b:5d:aa:55:f1:eb:bf:54:67:ad:48:3e:e8:
    ea:27:06:dd:05:2c:e3:83:54:3a:0a:03:3c:97:8c:
    e3:55:a9:9d:d8:2a:3e:5e:79:f2:9e:98:d3:0a:38:
    f2:8d:3c:18:19:d0:ed:e0:27:f8:44:56:d3:a2:41:
    79:0e:f4:fe:5a:ec:8f:44:5b:90:97:41:aa:8b:b5:
    ec:ed:9f:a5:32:56:d0:c3:38:7c:45:9a:f5:cf:03:
    09:69:90:20:84:b6:47:5e:ec:64:d2:13:db:f8:b5:
    f6:19:cc:5a:7b:ee:e4:df:9c:21:4e:77:cd:e7:e9:
    b2:4c:e6:bf:a5:5d:0c:b6:b4:a3:5a:6b:aa:fb:e6:
    94:41
prime1:
    00:f3:bb:7c:1e:7b:c8:d5:1c:d2:bc:95:1e:fb:f2:
    a7:8a:87:b6:3c:af:44:6d:de:87:30:98:cd:3e:1c:
    ee:1c:e1:a3:48:35:5b:c4:c9:81:98:3b:b1:16:00:
    3b:89:af:cf:44:64:0b:29:43:dc:aa:53:01:10:9a:
    3e:0b:cb:7b:83:20:1a:e6:ff:24:24:5b:e7:f1:8d:
    7e:81:d4:64:56:a5:7f:83:bc:95:f0:17:ac:ff:46:
    5b:0c:dc:c7:ad:ae:2f:39:5c:e4:20:ef:a0:a2:9c:
    bf:f7:f2:33:0a:64:81:3f:9e:a9:e3:f5:54:57:93:
    02:e2:5e:8e:79:34:c7:24:f3
prime2:
    00:d4:cc:7d:e7:96:ed:0d:66:bc:be:a2:49:0a:c5:
    dc:36:9f:80:bf:52:7d:74:8d:9e:4f:72:71:db:fe:
    c4:4c:d4:c2:00:3f:7c:af:fd:8f:af:26:e8:1e:ad:
    51:db:40:ea:13:f9:53:58:4d:3a:80:ea:61:1e:5d:
    4e:3b:2a:11:f1:86:95:ef:34:f4:6f:39:4f:e0:3a:
    13:bf:16:a6:a7:b5:da:87:c9:a0:9e:71:b4:16:31:
    92:72:52:9e:31:27:85:b1:00:08:7d:7f:95:24:6a:
    b0:fb:c5:16:4c:78:15:b2:ef:81:f0:e4:02:1d:0d:
    67:c0:86:77:9a:9f:d6:06:a1
exponent1:
    2a:84:01:da:af:6d:10:ff:be:22:f7:40:38:62:d3:
    a6:ee:95:73:70:7f:57:4b:01:fa:10:2d:7d:30:3e:
    b8:fb:03:28:8d:66:3c:a5:89:dd:ac:4b:ef:b2:8a:
    b0:31:e2:cd:e3:45:af:25:0f:51:06:b9:a0:d3:c7:
    0e:f7:a7:cb:ef:c5:c1:95:b0:10:47:97:e6:22:f0:
    76:65:3e:3b:7f:13:07:3f:d6:47:d3:59:72:0e:2b:
    c3:ca:9f:6a:44:80:28:59:73:d1:ea:fa:f2:62:b5:
    79:e2:dd:d4:6a:43:c1:7d:43:d5:67:ee:16:78:a6:
    80:26:4e:64:06:38:d6:d1
exponent2:
    00:9b:d7:d7:2d:50:3e:f3:5d:96:45:16:9c:df:a2:
    e0:0f:b0:e8:9d:35:50:63:97:83:a5:33:6f:67:6a:
    41:60:f3:3f:d0:e6:ad:ee:45:88:81:01:c1:65:16:
    11:a8:bc:f5:b1:03:1b:a2:c3:8c:60:f5:45:82:f3:
    5a:63:c1:ff:ba:1e:92:97:c8:f4:6a:b0:52:6b:28:
    9d:65:88:b5:2c:85:e6:31:23:dc:d9:ac:f3:f2:7d:
    03:7f:6e:3a:24:4d:89:7f:83:42:b4:86:47:37:90:
    5b:65:47:85:79:23:48:e0:ee:be:ff:28:3c:d4:02:
    09:45:da:34:a5:ad:01:15:81
coefficient:
    00:95:6c:a8:ea:09:b0:f3:4c:8a:dc:b7:c8:d0:c5:
    5a:c4:a4:d0:f5:25:c9:f2:42:80:1d:04:88:bc:2d:
    ff:1f:7d:5a:42:c4:18:4e:06:49:49:86:15:ea:8d:
    a6:7c:88:4e:e7:4b:bc:56:7c:33:91:d8:99:b4:45:
    4b:b4:dc:aa:67:59:c2:90:cf:b3:02:1a:39:17:55:
    6a:e6:e3:5d:93:d6:5a:e7:a7:65:25:0f:43:21:a8:
    ba:6c:db:b3:54:27:a6:f2:6e:bd:b4:d2:4c:07:c4:
    97:2b:64:b6:f4:a7:86:6e:18:5c:12:9f:d4:13:15:
    d1:86:dd:8f:ce:3d:11:96:86
$
</code>
</pre>
<!--
  modulus: n
  prime1: p or q
  prime2: q or p
  pube: e
  prie: d
  exp1, exp2, and coefficient are used in the Chinese Remainder Theorem
-->
<!-- bc code for these numbers:
ibase=16
n=00CA99F40F304662868E37EEB61F1C1E9B5C35B56905AB4892E5B9F101DB76A4C20CA21C8F395DC7A3275D29AD6194F1A240E155BC509D5EE8466E9B42C5967D4B0846495F53ACFC7F734763B1579D9777EFD4E68A32FA7C60F557C1C1439C131EA098D7D0BB4EB32C3B9F7322965E41770CE13BAE53D2AB5C4B9341B162AF95BD011EC4CA6132CC1D222A9CC78B3074359D03BC7BCFF9D7EA8A714C3A7EB58DCCFD0209561EA69F532F21B85CF8F0CB411BC48B566132202093AF4B900DF68315C569253EC790A5E38747EBD4895F7677C55872FDDA51A5A73DC847FF8956D2C95F73EDAB36A9C0FB3C47DADEF22243EE68D4EDCED231B8D1DF136F10AC3DEED3
p=00F3BB7C1E7BC8D51CD2BC951EFBF2A78A87B63CAF446DDE873098CD3E1CEE1CE1A348355BC4C981983BB116003B89AFCF44640B2943DCAA5301109A3E0BCB7B83201AE6FF24245BE7F18D7E81D46456A57F83BC95F017ACFF465B0CDCC7ADAE2F395CE420EFA0A29CBFF7F2330A64813F9EA9E3F554579302E25E8E7934C724F3
q=00D4CC7DE796ED0D66BCBEA2490AC5DC369F80BF527D748D9E4F7271DBFEC44CD4C2003F7CAFFD8FAF26E81EAD51DB40EA13F953584D3A80EA611E5D4E3B2A11F18695EF34F46F394FE03A13BF16A6A7B5DA87C9A09E71B416319272529E312785B100087D7F95246AB0FBC5164C7815B2EF81F0E4021D0D67C086779A9FD606A1
pube=10001
prie=009DC05415837C3A7914C19E603646F9D9F469697075D69172B7E7192E5E08BA6ED1D164356CF085629762E5F1B77A76CEE47FCFF70A3A0ECD03125A581A6B7BF17166F0F885B9BAFD2DF097425DBB3A564BEAD4FB24887F522B96822A0E8FB71F70E2B1A038482620B9E8048918D619592E312DFC260E7219324B5DAA55F1EBBF5467AD483EE8EA2706DD052CE383543A0A033C978CE355A99DD82A3E5E79F29E98D30A38F28D3C1819D0EDE027F84456D3A241790EF4FE5AEC8F445B909741AA8BB5ECED9FA53256D0C3387C459AF5CF030969902084B6475EEC64D213DBF8B5F619CC5A7BEEE4DF9C214E77CDE7E9B24CE6BFA55D0CB6B4A35A6BAAFBE69441
exp1=2A8401DAAF6D10FFBE22F7403862D3A6EE9573707F574B01FA102D7D303EB8FB03288D663CA589DDAC4BEFB28AB031E2CDE345AF250F5106B9A0D3C70EF7A7CBEFC5C195B0104797E622F076653E3B7F13073FD647D359720E2BC3CA9F6A4480285973D1EAFAF262B579E2DDD46A43C17D43D567EE1678A680264E640638D6D1
exp2=009BD7D72D503EF35D9645169CDFA2E00FB0E89D3550639783A5336F676A4160F33FD0E6ADEE45888101C1651611A8BCF5B1031BA2C38C60F54582F35A63C1FFBA1E9297C8F46AB0526B289D6588B52C85E63123DCD9ACF3F27D037F6E3A244D897F8342B4864737905B654785792348E0EEBEFF283CD4020945DA34A5AD011581
c=00956CA8EA09B0F34C8ADCB7C8D0C55AC4A4D0F525C9F242801D0488BC2DFF1F7D5A42C4184E0649498615EA8DA67C884EE74BBC567C3391D899B4454BB4DCAA6759C290CFB3021A3917556AE6E35D93D65AE7A765250F4321A8BA6CDBB35427A6F26EBDB4D24C07C4972B64B6F4A7866E185C129FD41315D186DD8FCE3D119686

p*q==n
scale=0
(prie*pube) % ((p-1)*(q-1))

-->
</section>
<section id="openssl-to-generate-view-ecdsa-keys" class="slide level2">
<h2><span class="r-fit-text">Openssl to generate &amp; view ECDSA keys</span></h2>
<pre class="code-wrapper"><code class="hljs awk small" style="height:auto">$ openssl ecparam -out ec_key.pem -name secp256k1 -genkey
$ cat ec_key.pem 
-----BEGIN EC PARAMETERS-----
BgUrgQQACg==
-----END EC PARAMETERS-----
-----BEGIN EC PRIVATE KEY-----
MHQCAQEEIGcgMEVvdpER8E/FsnK2CsUWJWy9X39WLHdDtvFHCx8zoAcGBSuBBAAK
oUQDQgAE3jzNUf91RHMzRiob3KZLZI3BFcxZMg7UeHrM6ifVAjTNcBi9iqwYlCy8
LYKcHMYYna0smEOaQL6o0oPDV2hh9w==
-----END EC PRIVATE KEY-----
$
</code></pre>
</section>
<section id="openssl-to-view-an-ecdsa-key" class="slide level2">
<h2>Openssl to view an ECDSA key</h2>
<!--
d=46645095665948752159725390617705266833925338929901767141886312735501806411571
qx=100520880278031488762125882754878952466629466830145810675677838350919375585844
qy=92922191582770924169293325173158913322815666845532262217119080172645576630775
-->
<pre class="code-wrapper"><code class="hljs awk small" style="height:auto">$ cat ec_key.pem
read EC key
Private-Key: (256 bit)
priv:
    67:20:30:45:6f:76:91:11:f0:4f:c5:b2:72:b6:0a:
    c5:16:25:6c:bd:5f:7f:56:2c:77:43:b6:f1:47:0b:
    1f:33
pub:
    04:de:3c:cd:51:ff:75:44:73:33:46:2a:1b:dc:a6:
    4b:64:8d:c1:15:cc:59:32:0e:d4:78:7a:cc:ea:27:
    d5:02:34:cd:70:18:bd:8a:ac:18:94:2c:bc:2d:82:
    9c:1c:c6:18:9d:ad:2c:98:43:9a:40:be:a8:d2:83:
    c3:57:68:61:f7
ASN1 OID: secp256k1
$
</code></pre>
<ul>
<li>Private key (scalar) <span class="math inline">\(d \approx 4.66 \ast 10^{76}\)</span></li>
<li>Public key (point) <span class="math inline">\(Q \approx (1.01 \ast 10^{76}, 9.29 \ast 10^{76})\)</span></li>
</ul>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../slides/images/quarto.webp" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://github.com/aaronbloomfield/ccc" class="uri">https://github.com/aaronbloomfield/ccc</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="quarto_files/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="quarto_files/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="quarto_files/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="quarto_files/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="quarto_files/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="quarto_files/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="quarto_files/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="quarto_files/revealjs/plugin/notes/notes.js"></script>
  <script src="quarto_files/revealjs/plugin/search/search.js"></script>
  <script src="quarto_files/revealjs/plugin/zoom/zoom.js"></script>
  <script src="quarto_files/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': false,
'previewLinksAuto': true,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'h.v',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
              // target, if specified
              link.setAttribute("target", "_blank");
              if (link.getAttribute("rel") === null) {
                link.setAttribute("rel", "noopener");
              }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>